<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>熟語づくりカードゲーム（オンライン）</title>
<style>
  :root{
    --bg1:#eef2ff; --bg2:#f3e8ff;
    --card:#ffffffd9;
    --ink:#111827; --sub:#4b5563;
    --primary:#4f46e5; --primarySoft:#e0e7ff;
    --ok:#16a34a; --ng:#dc2626;
    --border:#d1d5db;
    --shadow:0 10px 25px rgba(0,0,0,.08);
    --radius:18px;
    --sameTileSize: 110px;
  }
  *{ box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
  body{
    margin:0; min-height:100vh; padding:16px;
    display:flex; justify-content:center; align-items:center;
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Hiragino Kaku Gothic ProN","Yu Gothic","Meiryo",sans-serif;
    color:var(--ink);
  }
  .app{
    width:min(1080px,100%);
    background:var(--card);
    border:1px solid var(--border);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    overflow:hidden;
    position:relative;
  }
  header{
    padding:16px 18px;
    border-bottom:1px solid var(--border);
    display:flex; gap:12px; align-items:center; justify-content:space-between;
    background:linear-gradient(180deg,#ffffffcc,#ffffff99);
  }
  header h1{ margin:0; font-size:18px; letter-spacing:.02em; }
  .pill{
    font-size:12px; color:var(--sub);
    background:var(--primarySoft);
    border:1px solid #c7d2fe;
    padding:6px 10px;
    border-radius:999px;
    display:inline-flex; gap:8px; align-items:center;
    white-space:nowrap;
  }
  .wrap{ padding:16px 18px 18px; display:grid; gap:14px; }

  .grid{
    display:grid;
    grid-template-columns: 1.75fr .25fr;
    gap:14px;
  }
  @media (max-width:980px){
    .grid{ grid-template-columns:1fr; }
  }

  .card{
    background:#fff;
    border:1px solid var(--border);
    border-radius:16px;
    padding:14px;
  }
  .card h2{
    margin:0 0 10px 0;
    font-size:14px;
    color:var(--sub);
    font-weight:700;
    letter-spacing:.02em;
  }

  .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
  .row > *{ flex:0 0 auto; }

  button{
    border:1px solid var(--border);
    background:#fff;
    color:var(--ink);
    border-radius:14px;
    padding:10px 12px;
    font-weight:700;
    cursor:pointer;
    box-shadow:0 6px 16px rgba(0,0,0,.06);
  }
  button.primary{
    background:var(--primary);
    border-color:var(--primary);
    color:#fff;
  }
  button.warn{
    background:#fff7ed;
    border-color:#fed7aa;
  }
  button:disabled{ opacity:.5; cursor:not-allowed; box-shadow:none; }
  select, input{
    border:1px solid var(--border);
    border-radius:12px;
    padding:10px 12px;
    font-weight:700;
    background:#fff;
    color:var(--ink);
  }
  input{ width:110px; }

  .sectionTitle{
    margin:14px 0 8px 0;
    font-size:15px;
    font-weight:900;
    color:var(--ink);
  }

  .tiles{
    display:grid;
    grid-template-columns: repeat(7, minmax(0, 1fr));
    gap:10px;
  }
  @media (max-width:520px){ .tiles{ grid-template-columns: repeat(3, minmax(0, 1fr)); } }

  .tile{
    user-select:none;
    border:1px solid var(--border);
    border-radius:18px;
    background:#fff;
    padding:18px 0px;
    text-align:center;
    font-size:44px;
    font-weight:900;
    line-height:1;
    box-shadow:0 10px 22px rgba(0,0,0,.07);
    cursor:pointer;
    overflow:hidden;
  }

  .msg{
    margin-top:10px;
    padding:12px 14px;
    border-radius:16px;
    font-weight:900;
    font-size:16px;
    border:1px solid var(--border);
    background:#fff;
    color:var(--sub);
  }
  .msg.ok{ border-color:#bbf7d0; background:#ecfdf5; color:#166534; }
  .msg.ng{ border-color:#fecaca; background:#fff1f2; color:#991b1b; }

  .scoreboard{
    display:flex;
    gap:8px;
    flex-wrap:nowrap;
    align-items:stretch;
  }
  .pRow{
    flex:1 1 0;
    min-width:0;
    display:flex; gap:8px; align-items:flex-start; justify-content:space-between;
    padding:6px 10px;
    border:1px solid var(--border);
    border-radius:14px; background:#fff;
  }
  .pRow .left{
    display:flex; gap:8px; align-items:center; font-weight:900;
    min-width:0;
  }
  .pRow .left span:last-child{
    font-size:12px;
    white-space:nowrap;
  }
  .pRow .pts{
    font-weight:900; color:var(--ink);
    display:flex; gap:8px; align-items:center;
    white-space:nowrap;
    font-size:12px;
    flex-wrap:wrap;
    justify-content:flex-end;
  }
  .pRow .ptVal{ color:var(--ng); }
  .statusTag{
    display:block;
    margin-top:2px;
    font-size:11px;
    font-weight:900;
    padding:4px 8px;
    border-radius:999px;
    border:1px solid #fecaca;
    background:#fff1f2;
    color:#991b1b;
    white-space:nowrap;
    flex: 1 0 100%;
    text-align:right;
  }
  .statusTag.miss{
    border-color:#fed7aa;
    background:#fff7ed;
    color:#9a3412;
  }

  .dot{ width:10px; height:10px; border-radius:999px; background:#cbd5e1; }
  .pRow.active{
    border-color:#a5b4fc;
    background:#eef2ff;
    animation:activePulse 980ms ease-in-out infinite;
  }
  .pRow.active .dot{
    background:#4f46e5;
    animation:dotPulse 980ms ease-in-out infinite;
  }
  @keyframes activePulse{
    0%{ box-shadow:0 0 0 rgba(79,70,229,.0); transform:translateY(0); }
    50%{ box-shadow:0 0 0 6px rgba(79,70,229,.14); transform:translateY(-1px); }
    100%{ box-shadow:0 0 0 rgba(79,70,229,.0); transform:translateY(0); }
  }
  @keyframes dotPulse{
    0%{ transform:scale(1); opacity:.75; }
    50%{ transform:scale(1.25); opacity:1; }
    100%{ transform:scale(1); opacity:.75; }
  }

  details{ border:1px solid var(--border); border-radius:14px; overflow:hidden; background:#fff; }
  summary{
    cursor:pointer; padding:10px 12px; font-weight:900; color:var(--sub);
    list-style:none;
  }
  summary::-webkit-details-marker{ display:none; }
  .list{ padding:0 12px 12px; display:flex; gap:8px; flex-wrap:wrap; }
  .tag{
    font-size:14px;
    font-weight:900;
    color:var(--ink);
    background:#f1f5e9;
    border:1px solid #e2e8f0;
    padding:8px 12px;
    border-radius:999px;
  }
  .muted{ color:var(--sub); }

  /* 右側設定：改行しない */
  #rightSide .settingRow{ flex-wrap:nowrap; align-items:center; }
  #rightSide .settingRow label{ white-space:nowrap; flex:0 0 auto; }
  #rightSide .settingRow select,
  #rightSide .settingRow input{
    white-space:nowrap; flex:1 1 auto; min-width:0;
  }

  .drawPickGrid{
    display:grid;
    grid-template-columns: minmax(240px, 0.70fr) minmax(0, 1.30fr);
    gap:4px;
    align-items:start;
    margin-top:6px;
  }
  .drawPickCol{ min-width:0; }
  .drawPickCol .sectionTitle{ margin-top:0; }

  .pickPanel{
    display:flex; gap:12px; align-items:center;
    flex-wrap:nowrap;
    overflow:visible;
    background:#fff; border:1px solid var(--border);
    border-radius:18px; padding:14px;
    box-shadow:0 10px 22px rgba(0,0,0,.07);
    min-width:0;
  }

  .slotWrap{ display:flex; gap:8px; align-items:center; min-width:0; }
  .slotLabel{ font-size:14px; color:var(--sub); font-weight:900; }

  .slot{
    width:var(--sameTileSize); height:var(--sameTileSize);
    border-radius:18px;
    border:1px solid var(--border);
    background:#f8fafc;
    display:grid; place-items:center;
    font-size:44px; font-weight:900;
    cursor:pointer;
    user-select:none;
    overflow:hidden;
    flex:0 0 auto;
  }
  .slot.filled{ background:#fff; }

  .eq{ font-weight:900; color:var(--sub); font-size:20px; flex:0 0 auto; }

  .wordBox{
    min-width:120px;
    padding:14px 16px;
    border-radius:18px;
    border:1px solid var(--border);
    background:#fff;
    font-weight:900;
    font-size:28px;
    text-align:center;
    flex:1 1 auto;
    white-space:nowrap;
  }

  .chip{
    border:1px solid var(--border);
    background:#fff;
    border-radius:999px;
    padding:10px 14px;
    font-weight:900;
    cursor:pointer;
    display:inline-flex;
    align-items:center;
    gap:10px;
    box-shadow:0 6px 16px rgba(0,0,0,.06);
  }
  .chip .mini{
    width:var(--sameTileSize); height:var(--sameTileSize);
    display:grid; place-items:center;
    border-radius:18px;
    border:1px solid var(--border);
    font-size:44px;
    font-weight:900;
    background:#f8fafc;
    line-height:1;
    overflow:hidden;
  }
  .chip:disabled{ opacity:.5; cursor:not-allowed; box-shadow:none; }

  .ansSpeakWrap{
    margin-top:10px;
    display:flex;
    gap:10px;
    align-items:center;
    flex-wrap:wrap;
  }
  .ansSpeakBtn{
    display:none;
    align-items:center;
    gap:8px;
    font-weight:900;
    border-color:#c7d2fe;
    background:#eef2ff;
  }
  .ansInfo{
    display:none;
    width:100%;
    padding:12px 14px;
    border-radius:16px;
    border:1px solid #c7d2fe;
    background:#eef2ff;
    font-weight:900;
    color:#111827;
    line-height:1.6;
  }
  .ansInfo .sub{ color:var(--sub); font-weight:900; }

  ruby rt{ font-size:10px; color:var(--sub); font-weight:900; }

  .settings{ display:grid; gap:10px; margin-bottom:10px; }
  .settingRow{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .settingRow label{ font-weight:900; }

  /* ★オンライン接続カード */
  .onlineCard{
    border:1px dashed #c7d2fe;
    background:#eef2ff;
    border-radius:16px;
    padding:12px;
    display:grid;
    gap:8px;
  }
  .onlineRow{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
  .onlineRow input{ width:160px; }
  .tiny{ font-size:12px; color:var(--sub); font-weight:900; }
  .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }

  /* ★読み上げボタン群（右側） */
  .ttsRow{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
  .ttsRow button{ font-size:12px; padding:10px 12px; }

  /* ★漢字タイル内レイアウト（読み表示ON） */
  .kWrap{ display:grid; gap:4px; align-items:center; justify-items:center; }
  .kOn,.kKun{ font-size:11px; font-weight:900; color:var(--sub); line-height:1.1; }
  .kCore{ font-size:44px; font-weight:900; line-height:1; }

  /* ★くす玉 */
  .kusudamaOverlay{
    position:absolute; inset:0;
    display:none;
    place-items:center;
    background:rgba(15,23,42,.38);
    z-index:9999;
  }
  .kusudamaBox{
    width:min(520px,92%);
    background:#fff;
    border:1px solid var(--border);
    border-radius:22px;
    box-shadow:0 20px 60px rgba(0,0,0,.25);
    padding:18px 16px;
    text-align:center;
    position:relative;
    overflow:hidden;
  }
  .kusudama{
    width:220px; height:120px;
    margin:8px auto 10px;
    position:relative;
  }
  .ball{
    position:absolute; top:0; width:110px; height:110px;
    border-radius:999px;
    border:2px solid #c7d2fe;
    background:linear-gradient(180deg,#eef2ff,#ffffff);
  }
  .ball.left{ left:0; transform-origin:right center; }
  .ball.right{ right:0; transform-origin:left center; }
  .kusudama.burst .ball.left{ animation:openL 450ms ease-out forwards; }
  .kusudama.burst .ball.right{ animation:openR 450ms ease-out forwards; }
  @keyframes openL{ to{ transform:rotate(-28deg) translateX(-10px); opacity:.96; } }
  @keyframes openR{ to{ transform:rotate(28deg) translateX(10px); opacity:.96; } }

  .banner{
    font-weight:1000;
    font-size:20px;
    padding:10px 12px;
    border-radius:16px;
    border:1px solid #c7d2fe;
    background:#eef2ff;
    display:inline-block;
  }
  .streamers{
    position:absolute; inset:0;
    pointer-events:none;
  }
  .streamer{
    position:absolute; top:-10px; left:50%;
    width:10px; height:140px;
    background:linear-gradient(180deg,#a5b4fc,#ffffff00);
    border-radius:999px;
    transform:translateX(-50%) rotate(var(--r)) translateX(var(--x));
    animation:fall 1200ms ease-out forwards;
    opacity:.9;
  }
  @keyframes fall{
    to{ transform:translateX(-50%) rotate(var(--r)) translateX(var(--x)) translateY(260px); opacity:0; }
  }
</style>
</head>

<body>
<div class="app" id="app">
  <header>
    <h1>熟語づくりカードゲーム（オンライン）</h1>
    <div class="pill" id="topPill">未接続</div>
  </header>

  <div class="wrap">
    <div class="grid">

      <div class="card" id="leftPlay">
        <div class="scoreboard" id="scoreboard"></div>
        <div class="msg ok" id="winMsg" style="display:none;"></div>

        <div class="row" style="margin-bottom:12px; margin-top:12px;">
          <button class="primary" id="drawBtn">１まい引く</button>
          <button id="checkBtn">できた！</button>
          <button id="endBtn"><ruby>番<rt>ばん</rt></ruby>を<ruby>終<rt>お</rt></ruby>える</button>
          <button class="warn" id="skipNextBtn" style="display:none;">つぎへ</button>
          <button id="addFieldBtn" class="warn" style="display:none;">
            <ruby>場札<rt>ばふだ</rt></ruby>を<ruby>追加<rt>ついか</rt></ruby>する
          </button>
        </div>

        <div class="sectionTitle"><ruby>場札<rt>ばふだ</rt></ruby></div>
        <div class="tiles" id="field"></div>

        <div class="drawPickGrid">
          <div class="drawPickCol">
            <div class="sectionTitle"><ruby>引<rt>ひ</rt></ruby>いた<ruby>札<rt>ふだ</rt></ruby>（タップで①②へ）</div>
            <div class="row" style="gap:10px; margin-bottom:10px;">
              <button class="chip" id="drawChip" type="button" disabled>
                <span class="muted"><ruby>引札<rt>ひきふだ</rt></ruby></span>
                <span class="mini" id="drawMini">—</span>
                <span class="muted">→①②</span>
              </button>
            </div>
          </div>

          <div class="drawPickCol">
            <div class="sectionTitle"><ruby>順番<rt>じゅんばん</rt></ruby>を<ruby>決<rt>き</rt></ruby>めて<ruby>作<rt>つく</rt></ruby>る</div>
            <div class="pickPanel">
              <div class="slotWrap">
                <div class="slotLabel">①</div>
                <div class="slot" id="slot1" title="タップで消す">—</div>
              </div>
              <div class="eq">→</div>
              <div class="slotWrap">
                <div class="slotLabel">②</div>
                <div class="slot" id="slot2" title="タップで消す">—</div>
              </div>
              <div class="eq">=</div>
              <div class="wordBox" id="wordBox">—</div>
            </div>
          </div>
        </div>

        <div class="msg" id="msg">右の「ルーム作成 / 参加」でオンライン接続してね。</div>

        <div class="ansSpeakWrap" id="ansSpeakWrap">
          <button class="ansSpeakBtn" id="ansSpeakBtn" type="button" aria-label="正答の読みと意味をよみあげ">
            🔊 よみ・いみ・れいぶん
          </button>
          <div class="ansInfo" id="ansInfo" aria-live="polite"></div>
        </div>

        <details style="margin-top:12px;" open>
          <summary><ruby>できた</ruby>じゅく<ruby>語<rt>ご</rt></ruby>（<ruby>同<rt>おな</rt></ruby>じ<ruby>熟語<rt>じゅくご</rt></ruby>は1<ruby>回<rt>かい</rt></ruby>まで）</summary>
          <div class="list" id="madeList"></div>
        </details>
      </div>

      <div class="card" id="rightSide">

        <!-- ★オンライン接続 -->
        <div class="onlineCard">
          <div class="onlineRow">
            <button class="primary" id="createRoomBtn" type="button">ルーム作成</button>
            <input id="roomIdInput" class="mono" placeholder="ルームID" />
            <button id="joinRoomBtn" type="button">参加</button>
          </div>
          <div class="tiny">
            あなたのID：<span id="myIdText" class="mono">---</span><br>
            ルーム：<span id="roomText" class="mono">未接続</span> ／ 座席：<span id="seatText" class="mono">---</span>
          </div>
          <div class="tiny" id="onlineHint">
            ※ ルール：<b>自分の番の人だけ</b>操作できます（相手は画面が同期されるだけ）。
          </div>
        </div>

        <div class="settings" style="margin-top:10px;">
          <div class="settingRow">
            <label class="muted">出題</label>
            <select id="gradeSelect" title="出題する漢字">
              <option value="g1">1年の漢字</option>
              <option value="g2">2年の漢字</option>
              <option value="g12">1，2年の漢字</option>
              <option value="g3">3年の漢字</option>
              <option value="g123">1・2・3年の漢字</option>
            </select>
          </div>

          <div class="settingRow">
            <label class="muted">読み表示</label>
            <select id="readingToggle" title="音読み・訓読みの表示">
              <option value="on" selected>ある</option>
              <option value="off">なし</option>
            </select>
          </div>

          <div class="settingRow">
            <label class="muted">勝利ポイント</label>
            <input id="targetPoints" type="number" min="1" step="1" value="5"/>
          </div>

          <div class="settingRow">
            <label class="muted">ミスで休み</label>
            <select id="missLimit" title="この回数「その言葉はありません」で1回休み">
              <option value="2">2回</option>
              <option value="3" selected>3回</option>
              <option value="4">4回</option>
              <option value="5">5回</option>
              <option value="6">6回</option>
              <option value="7">7回</option>
              <option value="8">8回</option>
            </select>
          </div>

          <div class="settingRow" style="flex-direction:column; align-items:flex-start;">
            <button class="primary" id="startBtn">スタート</button>
            <button id="resetBtn">リセット</button>
          </div>
        </div>

        <details id="rules" style="margin-top:12px;">
          <summary><ruby>遊び方<rt>あそびかた</rt></ruby></summary>
          <div id="ruleText" style="padding:10px 12px 12px; color:var(--sub); font-weight:800; line-height:1.75;">
            <div>・オンライン：同じルームIDに入った2人で対戦します。</div>
            <div>・自分の番の人だけ操作できます（相手は同期表示）。</div>
            <div>・スタートはルーム内でどちらかが押せます（設定は押した人のものが反映）。</div>

            <!-- ★読み上げボタン（不足してたので追加） -->
            <div class="ttsRow">
              <button id="speakBtn" type="button">🔊 遊び方をよむ</button>
              <button id="stopSpeakBtn" type="button">⏹ とめる</button>
            </div>
          </div>
        </details>

      </div>
    </div>
  </div>

  <!-- ★くす玉（不足してたので追加） -->
  <div class="kusudamaOverlay" id="kusudamaOverlay" aria-hidden="true">
    <div class="kusudamaBox">
      <div class="banner" id="kusudamaBanner">勝ち！</div>
      <div class="kusudama" id="kusudama">
        <div class="ball left"></div>
        <div class="ball right"></div>
      </div>
      <div class="streamers" id="streamers"></div>
      <div style="font-weight:900; color:var(--sub); font-size:12px;">（自動で閉じます）</div>
    </div>
  </div>
</div>

<script type="module">
/* ===============================
   Firebase（v9 modular / CDN）
=============================== */
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import {
  getDatabase, ref, set, get, onValue,
  runTransaction, serverTimestamp
} from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

/* ★あなたのFirebase設定（そのまま反映） */
const firebaseConfig = {
  apiKey: "AIzaSyDGyfFnmlFjJNyj8gyHcNje0SowgtTjDyU",
  authDomain: "jyukugo-battle.firebaseapp.com",
  databaseURL: "https://jyukugo-battle-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "jyukugo-battle",
  storageBucket: "jyukugo-battle.firebasestorage.app",
  messagingSenderId: "15379559721",
  appId: "1:15379559721:web:9776dfdf39b4a38a047338"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

/* ===============================
   DOM
=============================== */
const el = (id)=>document.getElementById(id);
const topPill = el("topPill");
const msgEl = el("msg");

const createRoomBtn = el("createRoomBtn");
const joinRoomBtn = el("joinRoomBtn");
const roomIdInput = el("roomIdInput");
const myIdText = el("myIdText");
const roomText = el("roomText");
const seatText = el("seatText");

const drawBtn = el("drawBtn");
const checkBtn = el("checkBtn");
const endBtn = el("endBtn");
const skipNextBtn = el("skipNextBtn");
const addFieldBtn = el("addFieldBtn");

const gradeSelect = el("gradeSelect");
const readingToggle = el("readingToggle");
const targetPointsInp = el("targetPoints");
const missLimitSel = el("missLimit");
const startBtn = el("startBtn");
const resetBtn = el("resetBtn");

const fieldEl = el("field");
const scoreboardEl = el("scoreboard");
const madeListEl = el("madeList");
const winMsgEl = el("winMsg");

const drawChip = el("drawChip");
const drawMini = el("drawMini");
const slot1El = el("slot1");
const slot2El = el("slot2");
const wordBox = el("wordBox");

const ansSpeakBtn = el("ansSpeakBtn");
const ansInfo = el("ansInfo");

const speakBtn = el("speakBtn");
const stopSpeakBtn = el("stopSpeakBtn");

const kusudamaOverlay = el("kusudamaOverlay");
const kusudama = el("kusudama");
const streamers = el("streamers");
const kusudamaBanner = el("kusudamaBanner");

function setMsg(text, kind=""){
  msgEl.classList.remove("ok","ng");
  if(kind) msgEl.classList.add(kind);
  msgEl.textContent = text;
}
function setTop(text){ topPill.textContent = text; }

/* ===============================
   オンライン：クライアントID（Authなし）
=============================== */
function getOrMakeClientId(){
  const k="jyukugo_clientId_v1";
  let v = localStorage.getItem(k);
  if(!v){
    v = "c_" + Math.random().toString(36).slice(2,10) + Date.now().toString(36).slice(-4);
    localStorage.setItem(k, v);
  }
  return v;
}
const myId = getOrMakeClientId();
myIdText.textContent = myId;

/* ===============================
   ルーム状態
=============================== */
let roomId = null;
let seatIndex = -1;     // 0 or 1
let unsub = null;

function roomRef(id){ return ref(db, `rooms/${id}`); }
function stateRef(id){ return ref(db, `rooms/${id}/state`); }

/* ★初期State */
function makeInitialState(){
  return {
    ver: 1,
    createdAt: serverTimestamp(),
    settings: {
      gradeKey: gradeSelect.value,
      showReadings: (readingToggle.value === "on"),
      targetPoints: Math.max(1, Number(targetPointsInp.value)||5),
      missLimit: Number(missLimitSel.value)||3
    },
    players: [
      { seat:0, clientId:null, points:0, skipNext:false },
      { seat:1, clientId:null, points:0, skipNext:false }
    ],
    started: false,
    current: 0,
    deck: [],
    field: [],
    drewThisTurn: false,
    drawnKanji: null,
    missThisTurn: 0,
    slot1: null,
    slot2: null,
    made: [],
    holdAdvance: false,
    lastMsg: "ルームに参加しました。スタートを押すと開始します。"
  };
}

/* ===============================
   ルーム作成 / 参加
=============================== */
function makeRoomId(){
  const chars = "ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
  let s="";
  for(let i=0;i<6;i++) s += chars[Math.floor(Math.random()*chars.length)];
  return s;
}

async function createRoom(){
  const id = makeRoomId();
  const st = makeInitialState();
  st.players[0].clientId = myId;

  await set(roomRef(id), {
    createdAt: serverTimestamp(),
    state: st
  });

  await connectRoom(id);
}

async function joinRoom(id){
  const snap = await get(roomRef(id));
  if(!snap.exists()){
    setMsg("そのルームIDは見つかりませんでした。","ng");
    return;
  }
  await connectRoom(id);
}

async function connectRoom(id){
  roomId = id;
  roomText.textContent = id;
  setTop("接続中…");

  const stRef = stateRef(id);
  const result = await runTransaction(stRef, (cur)=>{
    if(!cur) return cur;

    const alreadySeat = (cur.players||[]).findIndex(p=>p && p.clientId === myId);
    if(alreadySeat >= 0) return cur;

    const players = cur.players || [];
    const empty = players.findIndex(p=>p && !p.clientId);
    if(empty < 0) return cur;

    players[empty] = { ...(players[empty]||{}), seat: empty, clientId: myId, points: players[empty]?.points||0, skipNext: !!players[empty]?.skipNext };
    cur.players = players;
    cur.lastMsg = "相手の参加を待っています…";
    return cur;
  });

  const val = result.snapshot.val();
  if(!val){
    setMsg("接続に失敗しました。","ng");
    setTop("未接続");
    return;
  }

  const idx = (val.players||[]).findIndex(p=>p && p.clientId === myId);
  if(idx < 0){
    setMsg("満員です（2人まで）。別のルームを作ってください。","ng");
    setTop("満員");
    seatIndex = -1;
    seatText.textContent = "---";
    return;
  }

  seatIndex = idx;
  seatText.textContent = String(seatIndex+1);
  setTop("接続OK");

  if(unsub) unsub();
  unsub = onValue(stRef, (snap2)=>{
    const st = snap2.val();
    if(!st) return;
    applyRemoteState(st);
  });

  setMsg("接続しました。相手にも同じルームIDを伝えて参加してもらってね。","ok");
}

/* ===============================
   共通
=============================== */
let remoteState = null;

function isMyTurn(st){
  const cur = st?.current ?? 0;
  const p = (st.players||[])[cur];
  return !!(p && p.clientId === myId);
}
function bothJoined(st){
  const ps = st.players||[];
  return ps.length>=2 && ps[0]?.clientId && ps[1]?.clientId;
}
function canActNow(st){
  return !!(roomId && st && st.started && bothJoined(st) && isMyTurn(st) && !st.holdAdvance);
}

/* ===============================
   データ
=============================== */
const KANJI_READINGS = {
  "音": { on:"オン", kun:"おと・ね" },
  "下": { on:"カ・ゲ", kun:"した・しも・さ（げる）・くだ（る）・お（りる）" },
  "火": { on:"カ", kun:"ひ" },
  "学": { on:"ガク", kun:"まな（ぶ）" },
  "気": { on:"キ・ケ", kun:"" },
  "金": { on:"キン・コン", kun:"かね・かな" },
  "空": { on:"クウ", kun:"そら・あ（く）・から" },
  "月": { on:"ゲツ・ガツ", kun:"つき" },
  "見": { on:"ケン", kun:"み（る）" },
  "口": { on:"コウ・ク", kun:"くち" },
  "山": { on:"サン", kun:"やま" },
  "車": { on:"シャ", kun:"くるま" },
  "手": { on:"シュ", kun:"て" },
  "出": { on:"シュツ", kun:"で（る）・だ（す）" },
  "小": { on:"ショウ", kun:"ちい（さい）・こ・お" },
  "上": { on:"ジョウ", kun:"うえ・うわ・かみ・あ（げる）・のぼ（る）" }, 
  "人": { on:"ジン・ニン", kun:"ひと" },
  "水": { on:"スイ", kun:"みず" },
  "生": { on:"セイ・ショウ", kun:"い（きる）・う（む）・は（える）・なま" },
  "先": { on:"セン", kun:"さき" },
  "足": { on:"ソク", kun:"あし・た（す）" },
  "大": { on:"ダイ・タイ", kun:"おお（きい）" },
  "中": { on:"チュウ・ジュウ", kun:"なか" },
  "天": { on:"テン", kun:"あま" },
  "日": { on:"ニチ・ジツ", kun:"ひ・か" },
  "入": { on:"ニュウ", kun:"い（れる）・はい（る）" },
  "年": { on:"ネン", kun:"とし" },
  "文": { on:"ブン・モン", kun:"ふみ" },
  "本": { on:"ホン", kun:"もと" },
  "名": { on:"メイ・ミョウ", kun:"な" },
  "目": { on:"モク", kun:"め" },
  "力": { on:"リョク・リキ", kun:"ちから" },

  "家": { on:"カ・ケ", kun:"いえ・や" },
  "会": { on:"カイ", kun:"あ（う）" },
  "海": { on:"カイ", kun:"うみ" },
  "外": { on:"ガイ・ゲ", kun:"そと・ほか・はず（す）" },
  "元": { on:"ゲン・ガン", kun:"もと" },
  "言": { on:"ゲン・ゴン", kun:"い（う）・こと" },
  "原": { on:"ゲン", kun:"はら" },
  "後": { on:"ゴ・コウ", kun:"のち・うし（ろ）・あと" },
  "行": { on:"コウ・ギョウ", kun:"い（く）・おこな（う）" },
  "国": { on:"コク", kun:"くに" },
  "作": { on:"サク・サ", kun:"つく（る）" },
  "書": { on:"ショク", kun:"か（く）" },
  "場": { on:"ジョウ", kun:"ば" },
  "食": { on:"ショク", kun:"た（べる）・く（う）" },
  "心": { on:"シン", kun:"こころ" },
  "新": { on:"シン", kun:"あたら（しい）・にい・あら（た）" },
  "数": { on:"スウ", kun:"かず・かぞ（える）" },
  "前": { on:"ゼン", kun:"まえ" },
  "体": { on:"タイ・テイ", kun:"からだ" },
  "地": { on:"チ・ジ", kun:"" },
  "長": { on:"チョウ", kun:"なが（い）" },
  "直": { on:"チョク・ジキ", kun:"なお（す）、ただ（ちに）" },
  "通": { on:"ツウ", kun:"とお（る）・かよ（う）" },
  "当": { on:"トウ", kun:"あ（たる）" },
  "頭": { on:"トウ・ズ", kun:"あたま・かしら" },
  "道": { on:"ドウ", kun:"みち" },
  "内": { on:"ナイ", kun:"うち" },
  "風": { on:"フウ", kun:"かぜ・かざ" },
  "分": { on:"フン・ブン・ブ", kun:"わ（ける）" },
  "方": { on:"ホウ", kun:"かた" },
  "門": { on:"モン", kun:"かど" },
  "夜": { on:"ヤ", kun:"よる・よ" },
  "野": { on:"ヤ", kun:"の" },
  "用": { on:"ヨウ", kun:"もち（いる）" },
  "来": { on:"ライ", kun:"く（る）" },

  "悪": { on:"アク・オ", kun:"わる（い）" },
  "意": { on:"イ", kun:"" },
  "運": { on:"ウン", kun:"はこ（ぶ）" },
  "化": { on:"カ・ケ", kun:"ば（ける）" },
  "開": { on:"カイ", kun:"ひら（く）・あ（く）" },
  "感": { on:"カン", kun:"" },
  "期": { on:"キ・ゴ", kun:"" },
  "業": { on:"ギョウ・ゴウ", kun:"わざ" },
  "局": { on:"キョク", kun:"" },
  "事": { on:"ジ", kun:"こと" },
  "実": { on:"ジツ", kun:"み・みの（る）" },
  "所": { on:"ショ", kun:"ところ" },
  "身": { on:"シン", kun:"み" },
  "進": { on:"シン", kun:"すす（む）" },
  "全": { on:"ゼン", kun:"まった（く）・すべ（て）" },
  "代": { on:"ダイ・タイ", kun:"か（える）・よ・しろ" },
  "着": { on:"チャク", kun:"き（る）・つ（く）" },
  "定": { on:"テイ・ジョウ", kun:"さだ（める）" },
  "転": { on:"テン", kun:"ころ（ぶ）" },
  "動": { on:"ドウ", kun:"うご（く）" },
  "配": { on:"ハイ", kun:"くば（る）" },
  "発": { on:"ハツ・ホツ", kun:"" },
  "筆": { on:"ヒツ", kun:"ふで" },
  "品": { on:"ヒン", kun:"しな" },
  "部": { on:"ブ", kun:"" },
  "物": { on:"ブツ・モツ", kun:"もの" },
  "平": { on:"ヘイ・ビョウ", kun:"たい（ら）・ひら" },
  "命": { on:"メイ・ミョウ", kun:"いのち" },
  "面": { on:"メン", kun:"おも・おもて・つら" },
  "洋": { on:"ヨウ", kun:"" },
  "流": { on:"リュウ・ル", kun:"なが（れる）" },
  "路": { on:"ロ", kun:"じ・みち" },
  "和": { on:"ワ", kun:"やわ（らぐ）・なご（む）" }
};

const KANJI_BY_GRADE = {
  g1: ["音","下","火","学","気","金","空","月","見","口","山","車","手","出","小","上","人","水","生","先","足","大","中","天","日","入","年","文","本","名","目","力"],
  g2: ["家","会","海","外","元","言","原","後","行","国","作","書","場","食","心","新","数","前","体","地","長","直","通","当","頭","道","内","風","分","方","門","夜","野","用","来"],
  g3: ["悪","意","運","化","開","感","期","業","局","事","実","所","身","進","全","代","着","定","転","動","配","発","筆","品","部","物","平","命","面","洋","流","路","和"]
};
KANJI_BY_GRADE.g12 = [...KANJI_BY_GRADE.g1, ...KANJI_BY_GRADE.g2];
KANJI_BY_GRADE.g123 = [...KANJI_BY_GRADE.g1, ...KANJI_BY_GRADE.g2, ...KANJI_BY_GRADE.g3];

/* ===== 熟語DB ===== */
const JUKUGO_TSV = `
おんかん	音の高い・低いなどのちがいを聞き分ける力	音感がよい人は音のちがいにすぐ気づきます
おんど	みんなで歌ったりおどったりするときの歌や調子	先生が音頭をとってみんなで手をたたきました
あしおと	人や動物が歩いたときに出る音	ろう下で足音がしてだれか来たと分かりました
しんおん	心ぞうが動くときに出る音	病院で心音を聞いてもらいました
ぜんおん	音と音の間が「半音2つ分」あいていること（音の間の広さ）	ピアノでドからレは全音です。
ちょうおん	声や音を長くのばして出す音	お父さんの「とう」は長音です
はつおん	言葉の音を声に出すこと	英語の発音をれんしゅうします
ほんね	心の中で本当に思っていること	本音を言うと、宿題はやりたくないです。
ものおと	物が動いたり当たったりして出る音	夜に物音がして目がさめました
わおん	いくつかの音を同時に鳴らした音	ピアノで和音をひくときれいにひびきます
かぶ	全体の中で下のほうの部分	黒板の下部に今日の宿題を書きました
かりゅう	川の流れで下のほう（海に近いほう）	川の下流には広い川原があります
げざん	山から下りること	暗くなる前に下山しました
げしゃ	次のえきで電車やバスからおりること	次の駅で下車してください
げすい	使った水などを集めて流すしくみ（またはその水）	台所で使った水は下水に流れます
げそく	くつやはきもの	げん関で下足をそろえました
げひん	言葉づかいやふるまいが上品でないようす	人をばかにする言い方は下品です
したぎ	服の下に身につける服	寒い日はあたたかい下着を着ます
したごころ	人に言えない、よくないねらい（ずるい気持ち）	おこづかいがほしくて手伝ったと思われたら、下心があるみたいだ。
したじ	もとになる部分／前もってしておく準備	絵をきれいにぬるために下地をぬりました
したび	前よりもさかんでなくなること	そのあそびは今では下火になりました
したみ	前もって見てようすをたしかめること	遠足の前に先生が場所を下見しました
しもき	一年などを前半後半に分けたときの後半	会社では下期の目標を決めます
へた	うまくできないこと	わたしは字を書くのが下手です
かざしも	風がふいていく方向	けむりが来ないように風下に立ちました
じょうげ	上と下	エレベーターで上下にいどうします
あしもと	足のまわりや立っている場所	夜は足下に気をつけて歩きましょう
ちか	地面の下	この建物の地下に店があります
ちょっか	すぐ下	看板の直下に立たないでください。
てした	命令を受けて動く人	親分の手下が集まりました
てんか	世の中全体	天下に名が知れた人です
としした	自分より年が若い人	年下の友だちと遊びました
ぶか	仕事で自分より立場が下の人	部下と話し合いをしました
もっか	今のところ	目下の目標は九九をおぼえることです
もんか	ある先生について学んでいる人たち	先生の門下で学びました
かき	火や熱に関すること	火気に注意してください
かこう	火山でマグマなどが出る穴	火山の火口を見学しました
かざん	地面の中の熱いものがふき出す山	日本には火山が多いです
かじ	火が出て建物などが燃えること	近くで火事がありました
かちゅう	火の中	火中に物を投げ入れてはいけません
かりょく	火がもつ強さ	火力を弱くしてください
ひもと	火が出はじめた場所	火元をたしかめました
くちび	物事が始まるきっかけ	先生が口火を切りました
じかび	なべなどを直接火にかけること	直火で料理します
しゅっか	火が出ること	台所から出火しました
たいか	大きな火事	町で大火がありました
ちゃっか	火をつけること	木に着火しました
のび	野原に広がって燃える火	野火が広がりました
はっか	物が原因で火が出ること	電池が発火しました
がくぎょう	勉強すること	学業に力を入れています
がくせい	学校で学んでいる人	兄は大学生です
がくちょう	大学のいちばん上の責任者	学長があいさつしました
がくない	学校の中	学内で行事があります
がくねん	学校での学ぶ年ごとの区分	学年が上がりました
がくぶ	大学で学ぶ分野ごとのまとまり	理科の学部に入ります
がくふう	その学校の学び方や考え方の特色	この学校には自由な学風があります
がくめい	生き物につけられた学問上の名前	植物には学名があります
がくりょく	学んだことを理解し使う力	学力を高めるために毎日勉強します
がっかい	研究について話し合う集まり	先生が学会に出ました
がっき	一年をいくつかに分けた学ぶ期間	新しい学期が始まります
かがく	自然のしくみを調べる学問	科学の実けんをしました
けんがく	実際に見て学ぶこと	工場を見学しました
こうがく	あとから学ぶこと	後学のためにもう少し説明してください
こくがく	日本の言葉や歴史などを研究する学問	国学について学びました
じつがく	生活や仕事に役立つ学問	実学を学ぶことは大切です
しょうがく	小学校で学ぶこと	小学での学びを大切にします
しんがく	次の学校に進むこと	中学へ進学します
すうがく	数や形のしくみを学ぶ教科	数学の問題をときました
だいがく	高校のあとに行く専門的に学ぶ学校	兄は大学に通っています
ちがく	地球や自然のしくみを調べる学問	地学で星の話を聞きました
ちゅうがく	小学校のあとに通う学校	来年中学に入ります
つうがく	学校に通うこと	毎日自転車で通学します
てんがく	通っている学校を変えること	引っこしで転学しました
にゅうがく	学校に入ること	四月に入学します
ぶんがく	文章や物語などを研究し味わう学問	文学の本を読みました
やがく	夜に学ぶ学校や勉強	仕事のあと夜学に通います
りきがく	物が動く力やはたらきを調べる学問	力学の考え方を学びました
きうん	物事が進みやすくなる流れ	大会に向けて気運が高まりました
きか	液体が気体に変わること	水が気化してかわきます
きごころ	気持ちが分かり合っていること	気心の知れた友だちです
きたい	形が決まらない空気のような状態	空気は気体です
きなが	あせらずゆっくり待てるようす	気長に結果を待ちます
きひん	上品でおちついた感じ	気品のある話し方です
きふう	その人や集団のふんいきや気質	明るい気風の学校です
きぶん	そのときの心のようす	今日は気分がいいです
きまえ	お金や物を気持ちよく出すようす	気前よく分けてくれました
きもん	虫などが空気を出し入れする体のあな	虫は気門で息をします
きりゅう	空気の流れ	空の気流が速くなっています
きりょく	がんばろうとする心の力	気力をふりしぼって走りました
けはい	何かが起こりそうなようす	雨の気配がします
いき	やろうとする気持ち	意気こんで発表しました
うちき	気が弱くて引っこみ思案なこと	内気な子でも手を上げました
うんき	運のめぐり合わせ	今年は運気がよさそうです
がいき	外の空気	外気を入れてかん気します
かき	火や熱に関すること	火気に注意しましょう
くうき	まわりにあって目に見えない気体	新しい空気を入れます
げんき	体や心がじょうぶなようす	今日も元気に学校へ行きます
じょうき	気持ちが高ぶって顔が赤くなるようす	走って上気した顔になりました
せいき	生き生きとした気分やいきおい。活気。	生気がよみがえる。
たいき	地球のまわりをつつむ空気	この季節は大気が不安定だから注意が必要
つうき	空気を通すこと	部屋の通気をよくします
てんき	空のようす	今日は天気がいいです
にんき	多くの人に好まれていること	この本は人気があります
へいき	気にしないで落ち着いていること	少し雨でも平気です
ほんき	まじめに取り組む気持ち	本気で練習します
みずけ	水をふくんでいるようす	紙に水気があります
わき	なごやかでやさしいふんいき	和気あいあいと話しました
わるぎ	わざと困らせようとする気持ち	悪気はありませんでした
かなもの	金属でできた道具や物	金物の音がしました
かねめ	お金としての価値	金目の物は大切にします
きんうん	お金に関する運	今年は金運がよいです
きんざん	金が取れる山	昔この山は金山でした
きんぴん	お金や貴重な物	金品を大切にあつかいます
あたまきん	はじめに払うお金	家を買うときに頭金を払いました
がんきん	もとのお金	元金を少しずつ返します
くちがね	入れ物の口につける金具	ふくろの口金が外れました
しゅっきん	お金を出すこと	口座から出金しました
たいきん	たくさんのお金	大金を持ち歩きません
だいきん	品物を買ったときに払うお金	代金をはらいました
にゅうきん	お金が入ること	給料が口座に入金されました
ねんきん	年をとったあとにもらうお金	年金の話を聞きました
からて	道具を使わず手や足で行う武道	空手を習っています
くうき	まわりにあって目に見えない気体	空気がきれいです
くうしゃ	人や荷物が乗っていない車	空車のタクシーを見つけました
くうぜん	これまでにないほど大きいこと	空前の記録が出ました
くうちゅう	地面や床から離れたところ	鳥が空中を飛びます
くうてん	うまく進まずむだに回ること	話し合いが空転しました
くうろ	空を通る道	飛行機は空路を進みます
おおぞら	広くひろがる空	青い大空が広がります
じょうくう	空の高いところ	上空を飛行機が通りました
てんくう	とても高い空	天空に星が見えます
よぞら	夜に見える空	夜空に月が出ました
げっしょく	月が地球の影に入り見えにくくなること	月食を観察しました
げつめん	月の表面	月面の写真を見ました
つきひ	時間の流れ	長い月日がたちました
つきみ	月を見て楽しむこと	家族で月見をしました
つきよ	月が出ている夜	明るい月夜でした
しんげつ	月がほとんど見えないとき	今夜は新月です
せんげつ	今の月の前の月	先月は雨が多かったです
ぜんげつ	今の月の前の月	前月の記録を見ます
ながつき	旧暦九月の名前	長月のころは夜が長いです
ねんげつ	長い時間	長い年月がたちました
ふみづき	旧暦七月の名前	文月には星祭りがあります
めいげつ	とくに美しい月	今夜は名月です
らいげつ	次の月	来月に行事があります
けんがく	実際に見て学ぶこと	工場を見学しました
けんとう	だいたいの目安	見当がつきました
けんぶつ	見て楽しむこと	祭りを見物しました
みごと	とてもすばらしいようす	見事な発表でした
みどころ	見る価値のあるところ	この町には見所があります
みほん	手本として見せるもの	見本を見て作ります
いけん	自分の考え	自分の意見を言いました
かいけん	人前で話し質問を受けること	市長が会見しました
がいけん	外から見たようす	外見で人を判断しません
かざみ	風の向きを知るための道具	風見が回っています
こうけん	あとから助けて支えること	成年後見人がつきました
したみ	前もって見てたしかめること	会場を下見しました
しょけん	見たり調べたりして思ったこと	先生の所見を聞きました
せんけん	先のことを見通す考え	先見の明があります
つきみ	月を見て楽しむこと	秋に月見をします
はっけん	今まで知られていなかったことを見つけること	新しい星を発見しました
くちかず	話す量	今日は口数が少ないです
くちぐるま	うまい言葉で人を動かすこと	口車に乗らないようにします
くちさき	言葉だけのこと	口先だけで約束しません
くちび	物事が始まるきっかけ	先生が口火を切りました
くちもと	口のまわり	口元を手でおさえました
こうがい	外の人に話すこと	この話は口外しないでください
こうじつ	本当の理由をかくす言いわけ	雨を口実に休みました
こうじょう	人前でのあいさつや話	開会の口上がありました
こうとう	書かずに口で話すこと	口頭で説明しました
わるくち	人のよくないところを言うこと	友だちの悪口を言いません
かいこう	口を開くこと	大きく開口しました
おおぐち	量や金額が多いこと	大口の注文が入りました
かこう	火山でマグマなどが出る穴	火山の火口を見ました
もんぐち	門の入り口	門口で待ち合わせました
こぐち	量や金額が少ないこと	小口の支払いです
じんこう	ある場所に住んでいる人の数	町の人口が増えました
てぐち	やり方や方法	新しい手口を考えます
でぐち	外に出るところ	出口はこちらです
さんかい	山と海	山海の幸を味わいます
さんじょう	山の上	山上から景色を見ました
さんすい	山や川の自然の景色	山水の絵を見ました
さんち	山が多い土地	山地が広がっています
さんちゅう	山の中	山中で道に迷いました
やまみち	山の中を通る道	山道を歩きます
さんもん	寺の門	山門をくぐりました
さんや	山や野原	山野をかけ回ります
だし	祭りで引く大きな飾り車	祭りで山車を引きました
やまかぜ	山から吹きおろす風	山風が強いです
やまぐに	山が多い国や地域	日本は山国です
やまじ	山の中の道	山路を歩いて進みます
やまて	町や土地の高いほう	山手の町に住んでいます
やまば	いちばん大切なところ	試合はここが山場です
しゃじょう	車の上	車上に荷物をのせました
しゃたい	車のからだの部分	車体をきれいにします
しゃちゅう	車の中	車中で本を読みました
しゃどう	車が通るための道	車道をわたるときは注意します
しゃない	車の中	車内では静かにします
がいしゃ	外国で作られた車	外車を見かけました
くうしゃ	人や荷物が乗っていない車	空車のバスが来ました
くちぐるま	うまい言葉で人を動かすこと	口車にだまされません
げしゃ	電車やバスなどからおりること	次の駅で下車します
すいしゃ	水の力で回る車	川に水車があります
ぜんしゃ	前を走っている車	前車とのきょりをとります
だし	祭りで引く大きな飾り車	町で山車が出ました
はいしゃ	車を手配すること	タクシーを配車しました
はっしゃ	車が出発すること	電車が発車しました
ふうしゃ	風の力で回る車	風車が回っています
しゅどう	人の手で動かすこと	手動でスイッチを入れます
てあし	手と足	手足をのばします
てあて	世話をしたりお金を支払ったりすること	けがの手当をしました
てすう	手間や作業の回数	手数が多くかかります
てぐち	やり方や方法	よい手口を考えます
てごころ	相手のことを考えて少し加減すること	手心を加えて教えました
てさき	指や手の先	手先を使って作ります
てした	命令を受けて動く人	親分の手下です
てじな	ふしぎに見せる芸	手品を見せてもらいました
てはい	前もって準備すること	会場の手配をします
てほん	まねをする見本	先生の字を手本にします
てまえ	自分の近く	手前にかばんを置きました
てもと	手の近くや今使っている物	手元の本を開きます
あくしゅ	よくない打ち手ややり方	その考えは悪手でした
あらて	あたらしいやり方	新手の方法を試します
じょうず	物事がうまくできること	字を書くのが上手です
おおて	規模が大きく力のあること	大手の会社です
からて	道具を使わず手や足で行う武道	空手の練習をします
こて	手や腕の一部分	小手を動かして打ちます
ごて	物事の動きが相手より遅れること	後手に回りました
へた	うまくできないこと	歌が下手です
せんて	相手より先に行動すること	先手を打ちました
ちゃくしゅ	仕事や勉強を始めること	計画に着手します
にゅうしゅ	手に入れること	資料を入手しました
ひとで	仕事をする人の数	人手が足りません
ひらて	ひらいた手のひら	平手でたたきました
めいしゅ	とても上手な人	野球の名手です
もとで	もとになるお金や材料	元手をためます
やしゅ	野球で守りをする選手	野手が守ります
やまて	町や土地の高いほう	山手の道を歩きます
しゅっか	火が出ること	夜に出火しました
しゅっきん	お金を出すこと	銀行で出金します
しゅっけ	家を出て仏門に入ること	昔は出家する人がいました
しゅっこく	国の外へ出ること	明日出国します
しゅっしん	生まれ育った場所	東京出身です
しゅっしょう	生まれること	新しい命が出生しました
しゅつじょう	大会や行事に出ること	大会に出場します
しゅっすい	川などの水が増えてあふれること	大雨で出水しました
しゅっとう	決められた場所に出向くこと	警察に出頭しました
しゅっきん	仕事のために職場へ行くこと	朝八時に出勤します
でいり	出たり入ったりすること	人の出入が多い店です
しゅっぱつ	出かけること	朝早く出発しました
しゅっぴん	品物を出して売ること	作品を出品します
しゅつりょく	力やエネルギーを外に出すこと	機械の出力を上げます
こぐち	量や金額が少ないこと	小口の注文です
こごと	こまかく言う注意	母に小言を言われました
こさく	人の土地を借りて作物を作ること	昔は小作をする人がいました
こて	手や腕のひじから先の部分	小手をのばします
こびと	体の小さい人／昔話の小さな人	小人が出てくる話です
こふで	小さく書くための筆	小筆で字を書きました
こみち	せまい道	小道を通って帰ります
こうじ	町の中にあるせまい道	小路を歩きました
こもの	小さな道具や品物	小物を整理します
しょうがく	小学校で学ぶこと	小学の学習を大切にします
しょうこく	国土や人口が小さい国	小国にも長い歴史があります
しょうじ	小さな出来事	小事を気にしません
しょうしょく	食べる量が少ないこと	小食な子です
しょうしん	気が小さくこわがりなこと	小心でもがんばります
しょうすう	一より小さい数	小数の計算をします
しょうひん	小さくまとまった作品	小品の絵を見ました
だいしょう	大きいことと小さいこと	大小の石があります
うわぎ	服の上に着る服	寒いので上着を着ます
じょうき	一年のはじめのほうの期間	上期のまとめをします
じょうず	物事がうまくできること	歌が上手です
じょうい	目上の人の考えや命令	上意にしたがいます
じょうき	顔が赤くなるほど気持ちが高ぶること	走って上気しました
じょうくう	空の高いところ	上空に雲があります
じょうげ	上と下	上下に動かします
じょうすい	飲み水として使う水	町の上水を守ります
じょうたい	体の上の部分	上体を起こします
じょうだい	品物につけられた値段	上代をたしかめます
しょうにん	仏教のお坊さん	上人の話を聞きました
じょうひん	言葉づかいやふるまいがていねいなこと	上品な話し方です
じょうもの	質がよい品物	上物の野菜です
かみがた	京都や大阪を中心とした地方	上方の文化を学びます
じょうりゅう	川の上のほう	川の上流で遊びました
かいじょう	海の上	船が海上を進みます
かざかみ	風がふいてくるほう	風上に立ちます
こうじょう	人前でのあいさつや話	開会の口上がありました
ごんじょう	目上の人に申し上げること	大名に言上しました
さんじょう	山の上	山上から町を見ました
しゃじょう	車の上	車上に荷物を積みます
しんじょう	その人の立場や暮らしのようす	身上を話しました
すいじょう	水の上	水上を船が進みます
ずじょう	頭の上	頭上に鳥が飛びました
ちじょう	地面の上	地上におります
ちょうじょう	年や立場が上の人	長上の人を立てます
てんじょう	空の上	天上の月が輝いている
としうえ	自分より年が多い人	年上の兄です
めうえ	立場や年が上の人	目上の人にあいさつします
ようじょう	広い海の上	洋上で日の出を見ました
ろじょう	道路の上	路上にごみをすてません
じんか	人の住んでいる家	人家が見えてきました
じんかい	とても多くの人	人海にまぎれました
じんご	人よりあと	人後に落ちません
じんこう	ある場所に住んでいる人の数	市の人口が増えました
じんじ	人に関わる事がら	人事をつくします
じんしん	人の心	人心をつかみます
じんしん	人の体や命	人身事故に注意します
じんせい	人が生きていく一生	人生について考えます
じんたい	人の体	人体のしくみを学びます
じんどう	人として正しい行い	人道に反する行いです
じんぴん	人の性格や品のよさ	人品のある人です
じんぶつ	人のようすや性格	すばらしい人物です
じんぶん	人の文化や考え方に関すること	人文の学びを深めます
じんめい	人の名前	人名を正しく書きます
じんめい	人のいのち	人命を守ります
じんめん	人の顔	人面の形をえがきます
じんりき	人の力	人力で運びます
にんき	多くの人に好まれていること	この店は人気です
にんずう	人の数	人数をかぞえます
にんそく	働く人	工事に人足が集まりました
ひとで	仕事をする人の数	人手が足りません
ひとで	人が集まること	祭りで人出が多いです
ひとまえ	ほかの人が見ているところ	人前で話します
ひとめ	人の目／見ている人	人目を気にします
あくにん	悪いことをする人	悪人をゆるしません
おとな	子どもではない人	大人になりました
がいじん	外国の人	外人の先生です
げんじん	大昔に生きていた人類	原人の生活を学びます
こびと	体の小さい人／昔話の小さな人	小人の話を読みました
しょうにん	仏教のお坊さん	上人の教えを聞きます
しんじん	新しく入ってきた人	新人が入りました
せんじん	昔の人	先人の知えに学びます
ぜんじん	それより前の人	前人の業績を調べます
てんにん	天に住むと考えられている人	天人のえを見ました
とうにん	その人自身	当人に聞きます
めいじん	とてもすぐれた人	書道の名人です
ぶんじん	文章や学問にすぐれた人	文人の書を読みました
ほんにん	その人自身	本人に確認します
もんじん	先生について学んでいる人	先生の門人です
すいうん	水の上を使った運び方	水運で物を運びます
すいしゃ	水の力で回る車	川で水車が回っています
すいじょう	水の上	水上を船が進みます
すいどう	水を家などに送るしくみ	水道の水を使います
すいぶん	水の成分や水の量	水分をしっかり取ります
すいへい	かたむいていないようす	机を水平にします
すいめん	水の表面	水面が光っています
すいもん	水の流れを調節する門	水門を開けます
すいりゅう	水の流れ	水流が速いです
すいりょく	水がもつ力	水力を利用します
すいろ	水が流れる道	水路をそうじします
みずぎ	水に入るときに着る服	水着に着がえます
みずけ	水をふくんでいるようす	紙に水気があります
おおみず	たくさんの水	大水で川があふれました
かいすい	海の水	海水はしょっぱいです
ぎょうずい	体を水で洗ってさっぱりすること	夏に行水します
げすい	使った水などを流すしくみ	下水を整えます
しゅっすい	川などの水が増えてあふれること	雨で出水しました
じょうすい	飲み水として使う水	上水を大切にします
しんすい	船を水にうかべること	船が進水しました
ちゃくすい	水の上に下りること	飛行機が着水しました
てんすい	雨など空からふる水	天水をためます
なまみず	わかしていない水	生水は飲みません
はいすい	水を分けて送ること	町に配水します
ようすい	生活や農業に使う水	田んぼに用水を引きます
りゅうすい	流れている水	流水がきれいです
きじ	布／もとになる材料	服の生地をえらびます
せいか	生まれ育った家	生家をたずねました
なりわい	生活のための仕事	家族の生業を学びました
せいご	生まれてからあと	生後三か月です
せいぜん	生きているあいだ	生前の話を聞きました
せいたい	生きている体	生体のしくみを調べます
せいちょう	生き物が大きく育つこと	植物が生長します
せいねん	生まれた年	生年を調べます
せいぶつ	生きているもの	海の生物を見ました
せいめい	生きているいのち	生命を大切にします
せいらい	生まれつき	生来の性格です
なまみ	生きているそのままの体	生身で寒さにたえます
がくせい	学校で学んでいる人	学生が集まります
げんせい	自然のままの状態	原生の森が残ります
しゅっしょう	生まれること	新しい命が出生しました
しょうせい	自分をへりくだって言う言い方	小生は未熟です
しんせい	新しく生まれ変わること	町が新生しました
じんせい	人が生きていく一生	人生を大切にします
せんせい	教えてくれる人	先生に質問します
てんせい	生まれ変わること	物語で転生します
はっせい	物事が起こること	事故が発生しました
へいぜい	ふだんいつも	平生から努力します
やせい	自然の中で育つこと	野生の動物です
せんげつ	今の月の前の月	先月の記録です
せんけん	先のことを見通す考え	先見の明があります
せんこう	先に行くこと	列の先行グループです
せんじつ	少し前の日	先日の話を思い出します
せんしん	ほかより先に進んでいること	先進の技術です
せんじん	昔の人	先人の知えに学びます
せんせい	教えてくれる人	先生に相談します
せんだい	前の代の人	先代の話を聞きました
せんちゃく	先に着くこと	先着順です
せんて	相手より先に行動すること	先手を打ちました
せんてん	生まれつきそなわっていること	彼の数学の才能は先天的なものだ
せんとう	いちばん先	列の先頭に立ちます
せんにゅう	先に入ること	会場に先入します
せんねん	少し前の年	先年の出来事です
せんぱつ	いちばん初めに出ること	先発の選手です
せんぽう	相手の人や相手の側	先方に連絡します
あとさき	前と後	後先を考えます
くちさき	言葉だけのこと	口先だけでは足りません
てさき	指や手の先	手先を使います
でさき	出かけた先	出先で雨に会いました
ふでさき	筆の先	筆先をととのえます
めさき	近い将来やすぐ前のこと	目先のことにとらわれません
あしだい	旅や移動に使うお金	足代を用意します
あしば	立ったり作業したりする場所	足場を固めます
あしもと	足のまわりや立っている場所	足元に注意します
げそく	くつやはきもの	下足をそろえます
ちょうそく	大きく進むこと	長足の進歩です
てあし	手と足	手足を動かします
であし	出て行くときの動き	出足が速いです
ほっそく	新しく始まること	新しい会が発足しました
おおかぜ	強い風	夜に大風がふきました
おおかた	だいたい	大方の予想が当たりました
おおぐち	量や金額が多いこと	大口の注文です
おおふで	大きな筆	大筆で字を書きました
おおみず	たくさんの水	大水で川があふれました
おおもの	力やえいきょうの大きい人や物	大物の選手です
おおじ	広い道	大路を歩きます
たいい	話や文章のおおまかな意味	話の大意をまとめます
たいきょく	全体の大きなようす	大局を見て考えます
たいざん	大きな山	大山に登りました
だいじ	とても大切なこと	体を大事にします
だいち	広い土地	大地に立ちます
ちゅうき	ある期間のまん中のころ	中期の計画です
ちゅうてん	空のまん中あたり	太陽が中天にあります
なかび	相撲や演劇などで、客に見せている期間の真ん中の日	夏場所もいよいよ中日をむかえる
ちゅうねん	大人のまん中ごろの年ごろ	中年の人です
ちゅうぶ	ある場所のまん中の部分	日本の中部地方です
ちゅうりゅう	上でも下でもないくらい	中流のくらしです
ちゅうわ	強さや性質をやわらげること	薬で中和します
なかみ	中に入っているもの	箱の中身を見ます
いちゅう	心の中で思っていること	意中の人です
めいちゅう	ねらったところに当たること	的に命中しました
てんがい	思いもよらないところ	天外な考えです
てんぴ	太陽の光	そめものを天日にさらす
てんぶん	生まれつきの才能	天分を生かします
てんめい	天から与えられた運命	天命を信じます
てんもん	星や空のようすを調べる学問	天文を学びます
こうてん	生まれたあとに身につくこと	後天の力です
のてん	屋根のない外	野天で食事をしました
にっしょく	太陽が月にかくれる現象	日食を観察しました
にっすう	日にちの数	日数を数えます
にっちゅう	昼のあいだ	日中は暑いです
にっちょく	その日当番をする人	今日は日直です
にっとう	一日分としてもらうお金	日当をもらいました
にほん	わたしたちが住んでいる国	日本に住んでいます
ひなが	昼の時間が長いこと	春は日長になります
ひより	天気のようす	今日はよい日和です
がんじつ	一年のはじめの日	元日に初日の出を見ました
きじつ	決められた日	期日までに出します
ごじつ	あとになってから	後日知らせます
すうじつ	何日か	数日休みます
せんじつ	少し前の日	先日の話です
ぜんじつ	その日の前の日	前日に準備します
ぜんじつ	一日じゅう	全日参加します
つきひ	時間の流れ	長い月日が流れました
とうじつ	その日	当日に集まります
へいじつ	土日や祝日でない日	平日に学校があります
ほんじつ	きょう	本日の予定です
めいにち	人が亡くなった日	祖父の命日です
らいにち	日本に来ること	外国から来日します
にゅうかい	会に入ること	クラブに入会しました
にゅうがく	学校に入ること	四月に入学します
にゅうきん	お金が入ること	口座に入金しました
にゅうこく	国の中に入ること	日本に入国しました
にゅうざん	山に入ること	朝から入山しました
にゅうしゅ	手に入れること	新しい本を入手しました
にゅうしょ	施設や場所に入ること	施設に入所しました
にゅうじょう	会場に入ること	入場の時間です
にゅうすい	水に入ること	川に入水しました
にゅうぶ	部活動に入ること	野球部に入部しました
にゅうもん	学び始めることやその入口	書道に入門しました
にゅうよう	必要なこと	入用な物を買います
にゅうりょく	文字や数字を機械に入れること	文字を入力します
でいり	出たり入ったりすること	人の出入が多い場所です
しんにゅう	中へ進んで入ること	立入禁止に進入しません
しんにゅう	新しく入ること	新入の生徒です
てんにゅう	よそから移って入ること	転入生が来ました
りゅうにゅう	流れこんで入ること	川に水が流入します
としうえ	自分より年が多い人	年上の兄です
としした	自分より年が少ない人	年下の友だちです
ねんき	あることを続ける決められた年数	年期が明けました
ねんきん	年をとったあとにもらうお金	年金の話を聞きました
ねんげつ	長い時間	長い年月がたちました
ねんじゅう	一年じゅう	年中花がさきます
ねんすう	年の数	年数を数えます
ねんだい	ある時代の区分	年代ごとに分けます
ねんちょう	年が上であること	年長の子です
ねんとう	年のはじめ	年頭に目標を立てます
ねんない	その年のうち	年内に終わらせます
ねんぱい	年のころ	年配の人です
らいねん	次の年	来年また会います
がくねん	学校で学ぶ年の区分	学年が上がりました
こうねん	のちの年	後年になって評価されました
しんねん	新しい年	新年をむかえました
せいねん	生まれた年	生年を調べます
せんねん	少し前の年	先年の出来事です
ぜんねん	その年の前の年	前年と比べます
ちゅうねん	大人のまん中ごろの年ごろ	中年の人です
ていねん	仕事をやめる決められた年	父は定年です
とうねん	その年	当年の計画です
ながねん	長いあいだ	長年の努力です
へいねん	特別なことのないふつうの年	平年の気温です
ほんねん	今年	本年もよろしくお願いします
らいねん	次の年	来年また会います
ふみづき	旧暦七月の名前	文月の夜は星がきれいです
ぶんい	文章の意味	文意を考えます
ぶんか	人々のくらしや考え方のまとまり	日本の文化を学びます
ぶんがく	文章や物語を学び味わう学問	文学の本を読みます
ぶんしょ	書かれた文や書類	文書を作ります
ぶんじん	文章を書くことにすぐれた人	文人の作品です
ぶんたい	文章の書き方の特徴	文体をくらべます
ぶんつう	手紙のやりとりをすること	友だちと文通します
ぶんぴつ	文章を書くこと	文筆の仕事です
ぶんぶつ	文化に関わる物	文物を大切にします
ぶんめん	書かれている文章の内容	文面を読みます
あくぶん	分かりにくい文章	悪文を直します
くうぶん	中身のない文章	空文では伝わりません
げんぶん	言葉と文章	言文のちがいを学びます
げんぶん	もとの文章	原文を読みます
こくぶん	その国の言葉で書かれた文章	国文の資料です
さくぶん	文章を書くこと	作文を書きました
じんぶん	人の文化や考え方に関する分野	人文の学びです
ぜんぶん	文章のすべて	全文を読みました
ちょうぶん	長い文章	長文にちょう戦します
てんもん	星や空のようすを調べる学問	天文の話を聞きました
ほんぶん	文章の中心となる部分	本文をよく読みます
めいぶん	よくできた文章	名文として知られています
わぶん	日本語で書かれた文章	和文で書きます
ほんい	本当に思っている考え	本意ではありません
ほんき	まじめに取り組む気持ち	本気で練習します
ほんぎょう	その人が主にしている仕事	本業に集中します
ほんきょく	組織や仕事の中心となる場所	本局に集まります
ほんけ	家の中心となる家	本家に集まりました
ほんごく	その人や会社のもとの国	本国に帰ります
ほんざん	宗派の中心となる寺	本山をたずねました
ほんじつ	きょう	本日の予定です
ほんしん	心の中の本当の気持ち	本心を話しました
ほんたい	もとになる大切な部分	本体を動かします
ほんとう	うそではないこと	それは本当です
ほんにん	その人自身	本人に聞きます
ほんね	心の中で本当に思っていること	本音を言いました
ほんねん	今年	本年の目標です
ほんば	もとになった場所	本場の味です
ほんぶ	組織の中心となる場所	本部に連絡します
ほんぶん	人として守るべきつとめ	本分をはたします
ほんぶん	文章の中心となる部分	本文を写します
ほんみょう	本当の名前	本名を書きます
ほんめい	いちばん大切だと思うもの	本命の相手です
ほんもの	にせものではない物	本物を見ました
ほんらい	もともと	本来の目的です
ほんりゅう	中心となる流れ	本流に戻ります
がんぽん	もとのお金	元本を守ります
げんぽん	写す前のもとの本	原本を確認します
しんぽん	新しく作られた本	新本が出ました
てほん	まねをする見本	先生の字を手本にします
にほん	わたしたちが住んでいる国	日本に住んでいます
はいほん	本を配ること	図書を配本します
みほん	手本として見せる物	見本を見て作ります
なまえ	人や物を区別するための呼び名	名前を書きます
みょうだい	代わりに用事をする人	名代として出かけます
めいか	よく知られた家	名家の出です
めいげつ	とくに美しい月	今夜は名月です
めいげん	心に残る大切な言葉	名言を心にとめます
めいさく	すぐれた作品	名作を読みました
めいざん	有名な山	名山に登ります
めいじつ	名前と中身	名実ともに立派です
めいしゅ	とても上手な人	野球の名手です
めいしょ	有名な場所	名所を見学します
めいじん	すぐれた技や力をもつ人	名人のわざです
めいひん	すぐれた品物	名品を集めます
めいぶつ	その土地で有名な物	町の名物です
めいぶん	よくできた文章	名文を音読します
めいもく	表向きの理由や名前	名目を立てます
めいもん	由緒のある家や学校	名門校です
あくめい	よくないことで広まった名前	悪名が広がります
がくめい	生き物につけられた学問上の名前	植物の学名です
かめい	家の名前	家名を守ります
じつめい	本当の名前	実名で書きます
しょめい	本の名前	書名を記録します
じんめい	人の名前	人名を調べます
だいみょう	昔の日本で土地を治めた人	大名の城です
ちめい	土地の名前	地名を覚えます
ひんめい	品物の名前	品名を確認します
ほんみょう	本当の名前	本名を書きました
めいめい	名前をつけること	新しい星に命名しました
わめい	日本で使われる名前	和名で呼びます
めうえ	年や立場が上の人	目上の人にあいさつします
めがしら	目の内側の角	目頭があつくなります
めかた	重さ	目方をはかります
めさき	近い将来やすぐ前のこと	目先のことを考えます
もっか	今のところ	目下の目標です
めもと	目のまわり	目元がやさしいです
もくぜん	目の前	目前にせまります
かねめ	お金としての価値	金目の物です
ちゃくもく	大事な点に目を向けること	変化に着目します
ひとめ	ほかの人の目	人目を気にします
ひらめ	魚の名前	平目を食べました
ひんもく	品物の種類	品目を分けます
みめ	見た目	見目がよい服です
めいもく	表向きの理由や名前	名目を立てました
めんもく	人としての立場や名誉	面目を保ちます
りきがく	物が動く力を調べる学問	力学を学びます
りきさく	力をこめて作った作品	力作が完成しました
がくりょく	学んだことを理解し使う力	学力を高めます
かりょく	火がもつ強さ	火力を弱めます
きりょく	がんばろうとする心の力	気力をふりしぼります
こくりょく	国がもつ力	国力を高めます
じつりょく	実際に身についている力	実力を発揮します
しゅつりょく	外に出す力やエネルギー	機械の出力を上げます
じりょく	もともともっている力	地力をつけます
じんりょく	人の力	人力で運びます
すいりょく	水がもつ力	水力を利用します
ぜんりょく	もっている力をすべて出すこと	全力で走ります
たいりょく	体の強さ	体力をきたえます
どうりょく	物を動かすもとになる力	動力を使います
にゅうりょく	文字や数字を機械に入れること	文字を入力します
ひつりょく	文章や字を書く力	筆力を高めます
ふうりょく	風がもつ力	風力で回します
いえじ	家へ帰る途中の道	夕方、家路を急ぎました
いえで	家を出て、帰らないでいること	家出をすると家族が心配します
かぎょう	その家が代々続けている仕事	父は家業を手つだっています
かじ	家の中で行う仕事（そうじや料理など）	家事を分けて手つだいます
かちょう	家族をまとめる立場の人	家長として家族を守ります
かない	自分の妻をへりくだって言う言葉	家内は料理が得意です
かふう	その家に代々伝わる考え方やならわし	この家は家風を大切にします
かめい	その家の名前や名声	家名にきずがつきました
けらい	主人につかえて働く人	家来が主人の命令を聞きました
こっか	国全体のこと	国家のきまりを守ります
さっか	小説や物語などを書く人	将来は作家になりたいです
じっか	生まれ育った家	夏休みに実家へ帰ります
しゅっけ	家を出て、僧になること	むかし、出家した人もいました
しょか	書道の作品を書く人	書家の字は力強いです
せいか	生まれた家	生家をたずねました
たいか	学問や芸術などですぐれた人	絵の大家の作品を見ました
とうけ	その家、自分の家	当家の決まりにしたがいます
ぶんけ	本家から分かれてできた家	分家として新しく家を建てました
へいけ	平氏という武士の一族	平家の物語を読みました
ほんけ	家系の中心となる家	正月は本家に集まります
めいか	世間によく知られた家	名家の出として知られています
かいき	会や集まりが行われる期間	会期は三日間です
かいけん	人前で話をしたり質問を受けたりすること	記者会見が開かれました
かいじょう	会や行事が行われる場所	会場に早めに着きました
かいしょく	一緒に食事をすること	友だちと会食しました
かいしん	とても満足すること、うまくいったこと	会心の出来でうれしいです
かいちょう	会のいちばん上の立場の人	会長があいさつしました
かいかい	会を始めること	九時に開会します
がっかい	学問について話し合う集まり	先生が学会に出ました
こっかい	国の大切なことを話し合って決める会	国会で法律を話し合います
たいかい	多くの人が集まる大きな会	運動大会がありました
にゅうかい	会の仲間に入ること	サッカークラブに入会します
ぶんかい	大きな会を分けて作った会	地域ごとに分会があります
めんかい	人と直接会うこと	病院で面会しました
やかい	夜に開かれる集まり	夜会で音楽を聞きました
うなばら	広くひらけた海	船から海原が見えました
かいうん	船を使って物を運ぶこと	海運で荷物を運びます
かいがい	外国や外国の地域	海外へ旅行に行きました
かいこく	海に囲まれた国	日本は海国です
かいじょう	海の上	海上に船が見えます
かいすい	海の水	海水はしょっぱいです
うみかぜ	海から吹いてくる風	海風が気持ちいいです
かいめん	海の表面	海面がきらきら光っています
かいろ	海を通る道	船は海路を進みます
かいよう	とても広い海	海洋ごみが問題です
そとうみ	陸から遠い広い海	外海は波が高いです
さんかい	山と海	山海の景色を楽しみました
たいかい	とても広く大きな海	大海へ船を出しました
うちうみ	陸地に入りこんだ海	内海は波がしずかです
がいき	外の空気	外気が冷たいです
がいけん	外から見たようす	外見で決めつけません
がいこく	ほかの国	外国の文化を学びます
がいしゃ	外国で作られた車	外車が道を走っています
がいしゅつ	家の外へ出ること	午後に外出します
がいしょく	家の外で食事をすること	今日は外食にします
がいじん	外国の人	外人の先生と話しました
がいち	外国の土地	外地でくらしたことがあります
がいぶ	外の部分	外部の人が来ました
がいめん	外から見えるようす	外面は元気そうです
がいや	関係のない立場	外野の意見は気にしません
がいよう	陸から遠い広い海	外洋を航海します
がいらい	外から来ること	外来の患者が来ました
げどう	人として正しくない行い	外道な行いはゆるされません
いがい	思っていたのとちがうこと	意外な答えでした
きょくがい	そのことに関わらない立場	局外の立場です
げんがい	言葉に出さない意味	言外の気持ちを考えます
こうがい	外の人に話すこと	秘密を口外しません
こくがい	国の外	国外へ出ます
じょうがい	会場の外	場外で待ちました
しんがい	思いがけず不満に思うこと	その言い方は心外です
てんがい	思いもよらないこと	天外な話でした
ないがい	内と外	内外の意見を聞きます
ぶがい	その組や集まりの外	部外者は入れません
もんがい	その分野の専門でないこと	門外なので教えてください
やがい	建物の外	野外で遊びました
がんきん	もとのお金	元金を守ります
がんじつ	一年のはじめの日（一月一日）	元日に初もうでをしました
がんぽん	もとのお金や資本	元本が大切です
がんらい	もともと	元来、静かな町です
げんき	体や心がじょうぶなようす	今日も元気です
もとで	もとになるお金や材料	元手をためて店を始めます
あしもと	足のまわりや、立っている場所	足元に気をつけて歩きます
いえもと	茶道や花道などで、その流派をまとめる中心の家（またはその人）	家元の考えを学びました
くちもと	口のまわり	口元をハンカチでふきます
くにもと	その人の出身地やもとの国	国元の家族に手紙を書きます
じもと	自分が住んでいる土地	地元のお祭りに行きました
ちゅうげん	夏のまん中ごろの時期（おくり物の時期）	中元の品を送ります
てもと	手の近くや、今使っているところ	手元の資料を見ます
ひもと	火が出はじめた場所	火元を確認しました
みもと	その人がどこのだれかということ	身元が分かりました
めさき	近い将来や、すぐ前のこと	目先のことにとらわれません
げんがい	言葉に出さない意味	言外の思いをくみ取ります
げんこう	言葉と行い	言行が一致しています
げんどう	言葉や行い	言動に気をつけます
きんげん	とても大切な言葉	金言を心に刻みます
こごと	こまかく言う注意	小言を言われました
しんげん	目上の人に意見を言うこと	意見を進言します
ぜんげん	前に言った言葉	前言を取り消します
たいげん	名詞など、物やことを表す言葉	体言を見分けます
ちょくげん	遠回しでなく、はっきり言うこと	直言してくれました
はつげん	自分の意見を言うこと	手を挙げて発言します
ほうげん	ある地域で使われる言葉	方言を覚えました
めいげん	心に残るすぐれた言葉	名言に感動しました
げんさく	もとになった作品	原作を読みました
げんしょ	もとの本	原書で確かめます
げんじん	大むかしに生きていた人類	原人のくらしを学びました
げんせい	自然のままの状態	原生の森が残っています
げんどう	動くもとになる力	原動となる考えです
げんぱつ	原子力で電気を作る発電所	原発のしくみを学びます
げんぶん	もとの文章	原文を読みました
げんぽん	写す前のもとの本	原本で確認します
げんや	人の手があまり入っていない広い野原	原野が広がっています
うなばら	広くひらけた海	海原に船が出ました
のはら	草が広がる野の場所	野原で遊びました
へいげん	広くて平らな土地	平原が続いています
あとさき	前と後	後先を考えて行動します
こうがく	あとから学ぶこと	後学のために聞きました
こうき	ある期間の後半	後期の授業が始まります
こうしん	あとから進んでくる人	後進の指導をします
こうてん	生まれたあとに身につくこと	後天的に学びます
こうてん	うしろ向きに回る動き	後転の練習をします
こうねん	のちの年	後年、思い出します
こうぶ	後ろの部分	車の後部です
こうほう	うしろのほう	後方を確認します
ごじつ	あとになってから	後日お知らせします
ごて	相手より動きが遅れること	後手に回りました
じご	出来事のあと	事後の対応をします
しょくご	食事のあと	食後に休みます
せいご	生まれてからあと	生後一年です
ぜんご	前と後	前後をよく確かめます
ちょくご	すぐあと	雨の直後は道がすべります
ぎょうじ	決まった日に行う行い	学校の行事があります
ぎょうしょ	少しくずして書く書き方	行書で名前を書きました
ぎょうずい	体を水で洗ってさっぱりすること	夏に行水をしました
ぎょうとう	行のはじめ	行頭をそろえます
こうしん	列を作って進むこと	みんなで行進します
こうどう	考えに基づいて動くこと	正しい行動をします
こうろ	通っていく道	行路を地図で確認します
ゆくえ	どこへ行ったか、先のようす	行方をさがします
あくぎょう	悪い行い	悪行は改めます
うんこう	決められた通りに動くこと	電車は予定通り運行します
じっこう	実際に行うこと	計画を実行します
しんこう	物事が進んでいくこと	工事が進行しています
せんこう	先に行くこと	先行して調べます
だいこう	代わりに行うこと	先生の仕事を代行します
ちょっこう	寄り道をせずに行くこと	家へ直行します
つうこう	道を通って行くこと	通行に注意します
はっこう	本や券などを出すこと	切手を発行します
ひんこう	人のふるまい	品行を正します
へいこう	同じ向きでならぶこと	線が平行です
やこう	夜に行くこと	夜行列車に乗ります
ようこう	外国へ行くこと	父は洋行しました
りゅうこう	多くの人の間ではやること	流行の服です
くにもと	ふるさと、故郷	国元の母が米を送ってきた
こくうん	国の運命や勢い	国運を考えます
こくがい	国の外	国外へ出ます
こくどう	国が管理する大きな道	国道を通ります
こくない	国の中	国内で旅行します
こくぶん	その国の言葉で書かれた文章	国文を読みます
こくりょく	国がもつ力	国力を高めます
こっか	国とそのしくみ	国家の役割を学びます
こっかい	国の大切なことを話し合って決める会	国会中継を見ました
かいこく	海に囲まれた国	日本は海国です
かいこく	外国と交流を始めること	日本は開国しました
がいこく	ほかの国	外国の友だちがいます
しゅっこく	国の外へ出ること	空港で出国します
しょうこく	小さな国	小国でも工夫があります
ぜんこく	国じゅうすべて	全国大会に出ます
たいこく	力の大きな国	大国と交流します
ちゅうごく	アジアにある国の名前	中国の歴史を学びます
てんごく	しあわせな世界	天国のような場所です
にゅうこく	国の中に入ること	日本に入国しました
ほんごく	もとの国	本国へ帰ります
やまぐに	山が多い国や地域	日本は山国です
さぎょう	仕事として行うこと	作業を分けて進めます
さくひん	作ったもの	すてきな作品です
さくふう	作品のつくり方の特徴	作風に個性があります
さくぶん	文章を書くこと	作文を書きました
さくもつ	育てて作る植物	作物を育てます
さっか	文章や作品を作る人	有名な作家です
さどう	機械などが動くこと	機械が作動します
さよう	物が他に与えるはたらき	薬の作用を調べます
げんさく	もとになった作品	原作と映画を比べます
しょさ	動きやふるまい	ていねいな所作です
しんさく	新しく作った作品	新作が発表されました
たいさく	大きくて力のこもった作品	力のこもった大作です
どうさ	体や機械の動き	動作をゆっくり行います
ほっさ	急に起こる体の変化	発作が起きました
めいさく	とてもすぐれた作品	名作を読みました
りきさく	力をこめて作った作品	みんなの力作です
しょか	書道にすぐれた人	書家の展示を見ました
しょたい	文字の形の種類	読みやすい書体です
しょどう	字を書く芸術	書道を習っています
しょめい	本の名前	書名をメモします
しょめん	書かれた文書	書面で知らせます
しょもつ	本	古い書物を読みます
あくしょ	よくない内容の本	悪書に注意します
ぎょうしょ	少しくずした書き方	行書で書きました
げんしょ	もとの本	原書を確認します
だいしょ	代わりに書くこと	申請を代書します
ぶんしょ	書かれた文や書類	文書を提出します
ようしょ	外国の本	洋書を読みます
わしょ	日本の本	和書を集めます
じょうがい	会場の外	場外で待ちます
じょうない	会場の中	場内は静かです
ばかず	経験した回数	場数を踏みました
ばしょ	物や人があるところ	集合場所を決めます
ばめん	そのときのようす	大事な場面です
あしば	立ったり作業したりする場所	足場を確かめます
かいじょう	集まりを行う場所	会場に入ります
かいじょう	会場を開くこと	九時に開場します
しゅつじょう	大会や行事に出ること	大会に出場します
どうじょう	武道などを学ぶ場所	道場で練習します
にゅうじょう	会場に入ること	入場の列に並びます
ほんば	もとになった場所	本場の味です
やまば	いちばん大切なところ	ここが山場です
らいじょう	会場に来ること	多くの人が来場しました
しょくご	食事のあと	食後に歯をみがきます
しょくじ	ごはんを食べること	家族で食事します
しょくぜん	食事の前	食前に手を洗います
しょくつう	食べ物にくわしい人	父は食通です
しょくどう	食べ物が通る体の中の管	食道を通ります
しょくひん	食べ物	食品を選びます
しょくもつ	食べるもの	食物を大切にします
しょくよう	食べるために使うこと	食用の油です
しょっかん	食べたときの感じ	食感が楽しいです
あくしょく	よくない食べ方	悪食を改めます
かいしょく	人といっしょに食事をすること	会食の席です
がいしょく	家の外で食事をすること	今日は外食です
げっしょく	月が地球の影に入る現象	月食を見ました
しょうしょく	食べる量が少ないこと	小食でも元気です
たいしょく	たくさん食べること	大食は体に良くありません
ここち	気持ち。気分。	心地よい風です
しんおん	心ぞうが動くときの音	心音を聞きます
しんがい	思いがけず不満に思うこと	その言い方は心外です
しんちゅう	心の中で思っていること	心中を話しました
しんしん	心と体	心身をきたえます
しんとう	心の中	心頭に思い浮かべます
しんぱい	気がかりに思うこと	友だちを心配します
あくしん	いやな気持ち	悪心をいだきません
かいしん	思いどおりにうまくいくこと	これは、会心の作です
かんしん	すごいと思うこと	努力に感心しました
きごころ	気持ちが分かり合っていること	気心の知れた友だちです
したごころ	表に出さない考え	下心はありません
しょうしん	気が小さく、こわがりなこと	小心なので、冒険はできない
じんしん	人の心	人心をつかみます
ちゅうしん	まん中	町の中心です
てごころ	少し加減すること	手心を加えました
ないしん	心の中の思い	内心では喜んでいます
ほんしん	本当の気持ち	本心を話します
ものごころ	物事が分かる心	物心がついたころです
やしん	大きな望み	野心をいだきます
ようじん	気をつけること	足元に用心します
あらて	新しいやり方	新手の方法です
しんげつ	月がほとんど見えないとき	今夜は新月です
しんさく	新しく作った作品	新作を発表します
しんしゅつ	新しく現れること	新出の問題です
しんしん	新しく力をあらわしてくること	新進の研究者に期待する
しんじん	新しく入ってきた人	新人を迎えます
しんせい	新しく生まれ変わること	学校が新生します
しんちゃく	新しく届くこと	新着のお知らせです
しんどう	新しく作られた道	広い新道ができた
しんにゅう	新しく入ること	この方は新入生です
しんねん	新しい年	新年を祝います
しんぴん	新しい品物	新品を使います
しんぷう	今までにはない新しい考え方や、やり方	日本料理界に新風をふきこむ
しんしょ	新しく出た本	新書の感想文を書いた
すうがく	数や形のしくみを学ぶ教科	数学の授業が好きです
すうじつ	何日か	数日で終わります
くちかず	話す量	口数が少ない人です
しょうすう	一より小さい数や点を使った数	小数の計算をします
ていすう	決まった数	参加者が定数に達する
てすう	手間や作業の回数	お手数をかけました
あたまかず	人数や数	頭数をそろえます
にっすう	日にちの数	日数を数えます
にんずう	人の数	人数を確認します
ねんすう	年の数	年数がたちました
ばかず	経験した回数。多くの経験。	場数を踏みました
ぶすう	本や新聞の数	新聞の部数です
ぶんすう	全体を分けた数	分数を学びます
ぜんき	ある期間の前半	前期のまとめです
ぜんげつ	今の月の前の月	前月より増えました
ぜんげん	前に言った言葉	前言を守ります
ぜんご	前と後	前後を見ます
ぜんじつ	その日の前の日	前日に準備します
ぜんしゃ	前を走っている車	前車に注意します
ぜんしん	前の姿や前の立場	前身は別の学校です
ぜんしん	前へ進むこと	一歩前進します
ぜんじん	前の時代の人	前人の知恵を学びます
ぜんだい	前の代	前代の記録です
ぜんてん	前に回る動き	前転の練習をします
ぜんとう	頭の前のほう	前頭をぶつけました
ぜんねん	その年の前の年	前年より多いです
ぜんぽう	前のほう	前方を見ます
ぜんめん	前のほう全体	前面に出ます
ぜんや	その日の前の夜	試合の前夜は早く寝ました
きまえ	お金や物を気持ちよく出すようす	気前よくおごってくれました
くうぜん	これまでにないほど大きいこと	空前の人気です
じぜん	前もって	事前に知らせます
しょくぜん	食事の前	食前に手を洗います
せいぜん	生きているあいだ	生前の思い出です
ちょくぜん	すぐ前	出発の直前です
てまえ	自分の近く	手前に置きます
でまえ	料理などを届けてもらうこと	夜に出前を取りました
なまえ	人や物を区別するための呼び名	名前を書きます
ひとまえ	ほかの人が見ているところ	人前で話します
ふうぜん	危険が近いようす	風前のともしびです
めんぜん	目の前	面前で話しました
もくぜん	すぐ目の前	目前にせまります
もんぜん	門の前	門前で待ちます
たいかん	体で感じること	寒さを体感します
たいげん	名詞など、物やことを表す言葉	体言を見分けます
たいちょう	体の長さ	魚の体長を測ります
たいない	体の中	体内のしくみです
たいめん	人としての立場や名誉	体面を保ちます
たいりょく	体の強さ	体力をつけます
きたい	形が決まらない状態	空気は気体です
じったい	実際にあるもの	実体を確かめます
しゃたい	車のからだの部分	車体を調べます
じょうたい	体の上の部分	上体を起こします
しょたい	文字の形の種類	読みやすい書体です
しんたい	人の体	身体を大切にします
じんたい	人の体	人体の図です
せいたい	生きている体	生体の反応です
ぜんたい	すべてを合わせたもの	全体を見ます
だいたい	おおよそのようす	大体の予定を立てます
てんたい	星や月など空にある物	天体を観察します
ふうてい	見た目のようす	風体が変わりました
ぶったい	形のあるもの	重い物体です
ぶんたい	文章の書き方の特徴	文体を比べます
りゅうたい	液体や気体のように流れるもの	水は流体です
じがね	加工する前の金属	地金を集めます
じしょ	土地や場所	地所を調べます
じみち	こつこつ続けるようす	地道に努力します
じめん	地の表面	地面がぬれています
じもと	自分が住んでいる土地	地元を大切にします
じりょく	もともともっている力	地力を高めます
ちか	地面の下	地下に入ります
ちがく	地球や自然のしくみを学ぶ学問	地学を学びます
ちじょう	地面の上	地上に出ます
ちほう	ある地域	地方の文化です
ちめい	土地の名前	地名を覚えます
いじ	自分の考えを通そうとする気持ち	意地を張らないで
きじ	布やもとになる材料	生地を切ります
きょくち	限られたせまい地域	局地的な雨です
けんち	物事を見る立場	別の見地から考えます
ここち	感じのよさ	心地よい音です
さんち	山が多い土地	山地を歩きます
したじ	もとになる部分や準備	下地を作ります
じっち	実際の場所	実地で学びます
ちゃくち	地面におりること	安全に着地しました
てんち	空と地面、または世の中	天地がひっくり返る
とうち	この場所	当地の天気です
ないち	国内の土地	内地で学びます
へいち	平らな土地	平地を走ります
ようち	使うための土地	用地を確保します
ろじ	せまい道	路地を歩きます
ちょうおん	音を長くのばして出す音	長音をのばします
ちょうき	長い期間	長期の計画です
ちょうしょ	よいところ	長所を見つけます
ちょうじょう	年や立場が上の人	長上を敬います
ちょうしん	背が高い体つき	長身の選手です
ちょうそく	大きく進むこと	長足の進歩です
ちょうぶん	長い文章	長文を読みます
ちょうめい	長生きすること	長命を願います
ながつき	旧暦九月の名前	長月の行事です
ながねん	長いあいだ	長年の努力です
おもなが	顔が細長いこと	面長の顔です
かいちょう	会のまとめ役	会長が話します
がくちょう	大学のいちばん上の責任者	学長のあいさつです
かちょう	家族をまとめる人	家長が決めます
きなが	あせらず待つようす	気長に待ちます
きょくちょう	局のいちばん上の人	局長が説明します
しょちょう	事務所などの長	所長に会います
しんちょう	体の高さ	身長を測ります
せいちょう	生き物が大きく育つこと	植物が生長します
ぜんちょう	全体の長さ	全長を測ります
たいちょう	体の長さ	体長を調べます
ねんちょう	年が上であること	年長の人です
ひなが	昼の時間が長いこと	春は日長です
ぶちょう	部のまとめ役	部長が決定します
よなが	夜の時間が長いこと	秋は夜長です
じかび	火に直接あてること	直火で焼きます
じきひつ	自分で書いた文字	直筆の手紙です
ちょくげん	はっきり言うこと	直言しました
ちょくご	すぐあと	開始直後です
ちょくしん	まっすぐ進むこと	直進してください
ちょくぜん	すぐ前	出発直前です
ちょくつう	途中で止まらず通ること	直通電車です
ちょくめん	目の前で起こること	問題に直面します
ちょっかん	考える前に感じること	直感で選びます
ちょっこう	まっすぐ行くこと	家へ直行します
じっちょく	正直でまじめなこと	実直な人です
とうちょく	当番として夜などに仕事をすること	当直に入ります
にっちょく	その日の当番	今日は日直です
つうがく	学校に通うこと	毎日通学します
つうき	空気を通すこと	通気をよくします
つうこう	道を通ること	通行止めです
つうふう	風を通すこと	通風を確保します
つうぶん	分数の分母をそろえること	通分して計算します
つうろ	通るための道	通路をあけます
つや	亡くなった人のために夜通し行う集まり	通夜に出ます
かいつう	道や線が使えるようになること	道が開通します
しょくつう	食べ物にくわしい人	食通の友だちです
ぜんつう	全部が通じること	信号が全通します
ちょくつう	途中で止まらずに通ること	直通で行きます
ぶんつう	手紙でやりとりをすること	友だちと文通します
りゅうつう	物が売り買いされて動くこと	商品が流通します
とうい	ちょうどよい考え	当意の案です
とうきょ	その仕事を担当している役所	当局が調べます
とうけ	その家	当家の考えです
とうじつ	その日	当日に集まります
とうだい	今の時代	当代の文化です
とうち	この場所	当地の名物です
とうちょく	当番として夜などに仕事をすること	当直をします
とうにん	その人本人	当人に聞きます
とうねん	その年	当年の目標です
とうぶん	しばらくのあいだ	当分休みます
とうほう	こちら側	当方で準備します
とうめん	今のところ	当面の課題です
めあて	ねらい	目当の店です
てあて	世話をしたり、お金を支払ったりすること	手当を受けます
にっとう	一日分としてもらうお金	日当をもらいます
はいとう	利益などを分けて与えること	配当が出ます
ほんとう	うそではないこと	本当の話です
あたまきん	はじめに払うお金	頭金を払います
ずじょう	頭の上	頭上に注意
とうしん	頭の大きさを基準にした体の長さ	八頭身です
あたまかず	人数や数	頭数を数えます
とうぶ	頭の部分	頭部を守ります
とうもく	集団のまとめ役	頭目が指示します
おんど	みんなで歌ったり動いたりするときの調子	音頭を取ります
ぎょうとう	行のはじめ	行頭をそろえます
こうとう	話し言葉で言うこと	口頭で説明します
じとう	その土地を治めていた人（昔の役職）	地頭の役目です
しゅっとう	決められた所へ出て行くこと	出頭します
せんとう	いちばん前	先頭を歩きます
ぜんとう	前のほう	前頭に立ちます
ねんとう	年のはじめ	年頭のあいさつです
ひっとう	いちばん上・最初	筆頭の名前です
めがしら	目の内側の角	目頭をおさえます
ろとう	行くあてがないこと	路頭に迷います
どうけ	人を笑わせる役	道化の役です
どうじょう	武道や芸を学ぶ場所	道場で練習します
どうちゅう	行く途中	道中は安全です
どうろ	車や人が通る道	道路を渡ります
げどう	正しくない行い	外道な行いです
こくどう	国が管理する大きな道	国道を走ります
こみち	小さな道	小道を通ります
やまみち	山の中の道	山道を歩きます
じみち	こつこつとまじめにすること	地道に続けます
しゃどう	車が通る道	車道に出ません
しょくどう	口から胃まで食べ物が通る管	食道を通ります
しょどう	字を書く芸術	書道を習います
しんどう	新しくできた道	新道が開きます
じんどう	人として正しい行い	人道を守ります
すいどう	水を送るしくみ	水道を使います
おおどう	大きな道	大道を進みます
ちゅうどう	かたよらない考え方	中道をえらびます
のみち	野原の中の道	野道を歩きます
よみち	夜に通る道	夜道に気をつけて
ないき	気が弱くて引っこみ思案なこと	内気な子です
うちきん	代金の一部として先に払うお金	内金を入れます
ないかい	陸に囲まれた海	内海は波が静かです
ないがい	内と外	内外の意見です
ないじつ	表に出ていない本当の中身	内実を知ります
ないしん	心の中の思い	内心は不安です
ないち	国内の土地	内地に戻ります
ないつう	味方の中にいて、こっそり敵に通じること	敵側に内通する
ないてい	正式に決まる前に決めること	内定をもらいます
ないぶ	中の部分	内部を調べます
ないめん	心の中や表から見えない部分	内面を見ます
ないや	野球で内がわの守り	内野を守ります
がくない	学校の中	学内で活動します
かない	自分の家の中、または妻	家内と相談します
こくない	国の中	国内旅行です
しゃない	車の中	車内で待ちます
じょうない	会場の中	場内が混みます
たいない	体の中	体内に入ります
ねんない	その年のうち	年内に終えます
みうち	家族や親せき	身内で話します
かざかみ	風がふいてくるほう	風上に立ちます
かざしも	風がふいていくほう	風下に立ちません
かざみ	風の向きを知るための物	風見を見ます
ふうか	風や雨で形がくずれること	岩が風化します
ふうしゃ	風の力で回る車	風車が回ります
ふうぜん	すぐ消えそうなようす	風前の灯です
ふうてい	見た目や身なり	風体が変わります
ふうぶつ	その土地らしい自然や物	風物を楽しみます
ふうりょく	風がもつ力	風力を利用します
ふうりゅう	上品で味わいがあること	風流な景色です
あくふう	よくない風習やならわし	悪風にそまる
うみかぜ	海からふく風	海風が気持ちいい
おおかぜ	とても強い風	大風が吹きました
がくふう	学校や学問の進め方の特色	自由な学風です
かふう	家に伝わる考え方やならわし	家風を大切にします
さくふう	作品に表れる作者の特徴	作風が分かります
つうふう	風を通すこと	通風を良くします
やまかぜ	山からふく風	山風が冷たい
ようふう	西洋のやり方や様式	洋風の家です
よかぜ	夜にふく風	夜風に当たります
わふう	日本風のやり方や様式	和風の料理です
ぶんか	分かれてちがいが生まれること	文化が分化します
ぶんかい	全体を分けた一つの会	分会を開きます
ぶんぎょう	仕事を分けて行うこと	分業で進めます
ぶんけ	本家から分かれた家	分家を立てます
ぶんしん	自分の代わりのような存在	分身の術です
ぶんすう	全体を分けたときの数	分数を学びます
ぶんぱい	分けて配ること	公平に分配します
ぶんや	専門となる範囲	得意な分野です
ぶんりゅう	流れが分かれること	川が分流します
きぶん	そのときの心のようす	気分がいい
すいぶん	水の成分	水分をとります
つうぶん	分数の分母を同じにすること	通分します
てんぶん	生まれつきもっている才能	天分をのばす教育をする
とうぶん	しばらくのあいだ	当分休みます
のわき	秋にふく強い風	野分が来ました
はいぶん	分けて配ること	役割を配分します
ぶぶん	全体の中の一つのところ	一部分です
ほんぶん	その人が本来しなければならないつとめ	学生の本分は勉強だ。
みぶん	その人の立場	身分をわきまえます
やぶん	夜の時間	夜分に失礼します
ほうげん	地方ごとの言葉	方言で話します
ほうめん	ある方向や地域	北の方面です
おおかた	だいたいのところ	大方できました
かみがた	京都・大阪を中心とした地方	上方の文化です
こうほう	うしろのほう	後方を確認します
せんぽう	相手の人や相手の側	先方に連絡します
ぜんぽう	前のほう	前方を見ます
ちほう	国の中のある地域	地方の町です
とうほう	こちらの側	当方で対応します
へいほう	正方形の面積	平方を計算します
めかた	重さ	目方を量ります
ゆくえ	どこへ行ったかという先	行方を探します
かどぐち	門の前	門口に立ちます
かどで	新しく出発すること	門出を祝います
もんか	先生について学ぶ人たち	門下に入ります
もんじん	師について学ぶ人	門人が集まります
もんぜん	門の前	門前で待ちます
かいもん	門を開くこと	朝に開門します
きもん	昆虫が呼吸する穴	気門で呼吸します
さんもん	寺の正面の門	山門をくぐります
すいもん	水を調節する門	水門を開けます
ぜんもん	前にある門	前門を通ります
にゅうもん	学び始めること	剣道に入門します
ぶもん	分けられた仕事や分野	担当部門です
めいもん	名が知られた家や学校	名門校です
やかい	夜にひらく集まり	夜会に出ます
やがく	夜に勉強する学校	夜学に通います
やぎょう	夜に行う仕事	夜業が続きます
やこう	夜に出かけたり進んだりすること	夜行バスです
やしょく	夜に食べる食事	夜食をとります
やぶん	夜の時間	夜分に帰ります
やらい	夜になってから	夜来の雨がやんだ
よかぜ	夜にふく風	夜風が涼しい
よぞら	夜の空	夜空を見上げます
よなか	夜のまん中ごろ	夜中に目がさめます
よなが	夜が長く感じられる時期	秋は夜長です
よみち	夜に通る道	夜道に注意します
ぜんや	ある日の前の夜	試合の前夜です
つきよ	月が出て明るい夜	月夜の散歩です
つや	亡くなった人を思って夜通し行う集まり	通夜に参列します
にちや	昼と夜、いつも	日夜努力します
のなか	野原の中	野中を歩きます
のはら	草が広がる平らな土地	野原で遊びます
のび	野原で起こる火事	野火に注意します
のみち	野原の中の道	野道を進みます
のやま	山や野原	野山をかけます
のわき	秋にふく強い風	野分の季節です
やがい	建物の外	野外活動です
やしゅ	野球で守りをする選手	野手が守ります
やしん	大きな望みをもつ心	野心をいだきます
やせい	自然の中で育つこと	野生の動物です
がいや	自分に関係のない立場	外野は口出ししない
げんや	人の手があまり入っていない広い土地	原野が広がります
さんや	山と野原	山野を歩きます
ないや	野球で内側を守る場所	内野を守ります
ぶんや	専門となる範囲	得意な分野です
へいや	平らで広い土地	平野が広がります
ようい	前もって準備すること	用意をします
ようじ	しなければならないこと	用事があります
ようじん	気をつけること	用心してください
ようすい	農業などに使う水	用水を引きます
ようち	使うための土地	用地を確保します
ようひん	使うための物	生活用品です
あくよう	よくない目的で使うこと	悪用しません
うんよう	うまく使ってはたらかせること	制度を運用します
さよう	物が他に与えるはたらき	薬が作用します
じつよう	実際に役立つこと	実用的です
しょくよう	食べるために使うこと	食用の油です
しょよう	しなければならない用事	所用で出ます
だいよう	代わりに使うこと	代用します
ちゃくよう	服などを身につけること	制服を着用します
つうよう	役に立って使えること	英語は多くの国で通用する
てんよう	別の目的に使うこと	土地を転用します
にちよう	毎日の生活に使うこと（またはその物）	日用品です
にゅうよう	必要であること	お金が入用です
りゅうよう	ほかに使うべき物を勝手に使うこと	予算を流用します
らいい	相手が来た目的	来意を聞きます
らいき	次の期間	来期の計画です
らいげつ	次の月	来月会います
らいじょう	会場に来ること	多くが来場します
らいにち	日本に来ること	来日します
らいねん	次の年	来年の予定です
がいらい	外から来ること	外来の患者です
がんらい	もともと	元来元気です
けらい	主人につかえて働く人	家来が命令を聞きます
せいらい	生まれつき	生来の性格です
でき	物事ができあがること	仕事の出来がいい
ねんらい	長いあいだ	年来の友だちです
ほんらい	もともとそうであること	本来の目的です
やらい	前の夜からつづくこと	夜来の雨です
あくい	人をだましたり、きずつけたりしようとする気持ち。	悪意のあるうわさを広めるのはやめよう。
あくうん	運が悪く、よくないことが続くこと。	今日は悪運が重なって、バスにも乗りおくれた。
あくぎょう	してはいけない悪い行い。	悪行をくり返すと、みんなの信頼を失う。
あくじ	法律や社会の決まりに反する行い。	悪事に手を出さないように、自分を正す。
あくしょく	ふつうは食べないような物を好んで食べること。	テレビで悪食のチャレンジを見てびっくりした。
あくしゅ	失敗につながる、よくないやり方や手。	そこで言い返したのは悪手で、話がこじれてしまった。
あくしょ	内容がよくなく、ためにならない本。	うその情報ばかりの悪書には気をつけよう。
あくにん	悪い行いをする人。	悪人の言うことでも、全部がうそとは限らない。
あくひつ	字が下手で読みにくいこと。	ぼくは悪筆だから、ていねいに書くようにしている。
あくふう	社会によくない影響をあたえる習慣や風習。	悪風にそまる。
あくぶん	意味が分かりにくい、よくない文章。	先生に、説明が足りなくて悪文になっていると言われた。
あくめい	悪いことで世間に知られてしまう評判。	悪名が広まる前に、きちんとあやまった。
あくよう	本来はよい目的のものを、悪いことに使うこと。	人の写真を勝手に使うのは悪用になることがある。
あくろ	でこぼこしていて通りにくい道。	雨のあとで悪路になり、歩くのが大変だった。
あっか	状態が前より悪くなること。	かぜを放っておいたら、せきが悪化した。
わるぐち	人をきずつける言い方。	悪口を言うより、いいところを見つけたい。
わるぎ	わざと悪いことをしようとする気持ち。	悪気はなかったのに、言い方がきつかった。
いがい	思っていたこととちがうこと。	意外にその問題はかんたんだった。
いき	何かをやろうとする元気な気持ち。	意気こんで練習したら、少し上手になった。
いけん	自分の考え。	ぼくの意見も聞いてください。
いじ	自分の考えを曲げまいとする気持ち。	意地を張らずに、先にあやまればよかった。
いちゅう	心の中で思っていること／気に入っている相手。	意中の人に、あいさつできてうれしかった。
さくい	作品を作るときの作者の考え。	物語の作意をしっかり読み取る。
たいい	文章や話のだいたいの意味。	まず大意をつかんでから、くわしく読む。
ないい	表に出していない本当の考え。	佐藤君の内意を聞く。
ぶんい	文章にこめられた意味。	文意を考えながら、ゆっくり読んだ。
ほんい	本当に思っていること、本当の気持ち。	本意ではないけれど、今回はがまんした。
ようい	前もって準備をすること。	遠足の用意を前の日にすませた。
うんき	運のよさ・悪さのようす。	今日は運気がよい気がする。
うんこう	決まった道や時間で運ばれたり動いたりすること。	電車は時刻表どおりに運行している。
うんてん	車や機械を動かしてあやつること。	父は毎日車を運転して仕事に行く。
うんどう	体を動かすこと／物が動くこと。	休み時間に運動すると気分がすっきりする。
うんめい	人の力では変えられないと考えられるさだめ。	これも運命だと思って受け止めた。
うんよう	物や制度をうまく使うこと。	タブレットを学習に運用している。
かいうん	船を使って物を運ぶこと。	昔は海運がとても大切だった。
かいうん	運がよくなること。	お参りして開運を願った。
きうん	物事が進みそうな世の中の流れや雰囲気。	新しい考えが広がる気運が高まっている。
きんうん	お金に関する運のよしあし。	今年は金運がいいと聞いてうれしい。
こくうん	国全体の運命やゆくえ。	国運をかけた大事業。
すいうん	川や海を使って物を運ぶこと。	この町は水運で発展した。
めいうん	生死や成功がどうなるかというさだめ。	試合の結果は命運を分けた。
かがく	物の性質や変わり方を調べる学問。	理科で化学の実験をした。
けしん	別のものの姿になって現れたもの。	物語では、神が人の化身として現れる。
かいか	文化や考え方が進んで新しくなること。	町は外国の文化で開化した。
きか	液体が気体に変わること。	水が水蒸気になるのは気化だ。
しんか	よりよい形へ変わっていくこと。	生き物は長い時間をかけて進化する。
てんか	性質や形が別のものに変わること。	熱を加えて物質が転化した。
どうけ	人を笑わせる役や、ふざけたふるまい。	道化のしぐさに、みんなが笑った。
ふうか	時間がたって、形や意味がうすれていくこと。	長い年月で石の文字が風化した。
ぶんか	人々のくらしの中で受けつがれてきた考え方や習慣。	日本の文化を大切にしたい。
ぶんか	一つのものが、役割ごとに分かれていくこと。	体の中で細胞が分化していく。
かいかい	会や集まりを始めること。	校長先生のあいさつで開会した。
かいぎょう	仕事や店を新しく始めること。	父は去年、小さな店を開業した。
かいきょく	放送局などを新しく作って始めること。	新しいテレビ局が開局した。
かいこう	口を開くこと。	先生が開口一番、大事な話をした。
かいこく	外国との行き来や貿易を始めること。	日本は昔、開国して世界とつながった。
かいじょう	会場を開いて人を入れること。	開場前から人がならんでいた。
かいつう	道や線路などが使えるようになること。	新しい橋が開通した。
かいはつ	土地や技術を役立つように作り出すこと。	町の開発が進んでいる。
かいもん	門を開くこと。	朝になると学校の門が開門する。
ぜんかい	全部を開くこと。	窓を全開にして空気を入れかえた。
かんか	人の考えや行いに影響をあたえること。	本の言葉に強く感化された。
かんしん	すごいと思って心を動かされること。	弟のがんばりに感心した。
かんどう	心が強く動かされること。	映画を見て感動した。
おんかん	音の高さや強さのちがいを聞き分ける力。	彼女は音感がとてもよい。
じっかん	実際に体や心で感じること。	練習の大切さを実感した。
しょかん	見たり聞いたりして思ったこと。	旅行の所感を作文に書いた。
しょっかん	食べたときのかたさや歯ざわり。	このりんごは食感がいい。
たいかん	体で直接感じること。	寒さを体感する朝だった。
ちょっかん	よく考えなくても、すぐに感じ取ること。	直感で答えを選んだ。
りきかん	力の強さや手ごたえの感じ。	ボールに力感があった。
りゅうかん	インフルエンザのこと。	冬になると流感が流行する。
きじつ	決められた日。	しめ切りの期日を守ろう。
かいき	会や集まりが開かれている期間。	会期は三日間です。
がっき	学校で区切っている学ぶ期間。	二学期が始まった。
かみき	一年の前半の期間。	上期の成績が発表された。
こうき	一年の後半の期間。	後期も目標を立ててがんばる。
しもき	一年の後半の期間。	下期に向けて新しい計画を立てた。
ぜんき	期間のはじめのほう。	前期は体調をくずしがちだった。
ちゅうき	期間のまんなかのころ。	中期で計画を見直した。
ちょうき	長い期間。	長期の休みを使って旅行した。
ていき	決まった時期ごとに行うこと。	定期テストの勉強を始めた。
ねんき	あることを続けてきた年数。	この仕事も年期が入ってきた。
らいき	次に来る期間。	来期の予定を話し合った。
かいぎょう	仕事や店を新しく始めること。	兄は春に開業する予定だ。
かぎょう	家で代々続けている仕事。	実家の家業を手伝っている。
さぎょう	仕事として行うしごとや動き。	静かに作業を進めた。
じぎょう	社会のために計画して行う大きな仕事。	新しい事業が始まった。
じつぎょう	物を作ったり売ったりする実際の仕事。	役所をやめて、実業につく。
しょぎょう	その人が行った行い（よい意味にも悪い意味にも使う）。	彼の所業は多くの人を驚かせた。
なりわい	生活のためにしている仕事。	漁業を生業としてくらしている。
てんぎょう	仕事の種類を変えること。	飲食店へ転業する
ぶんぎょう	仕事を分けて受け持つこと。	分業すると仕事がはかどる。
ほんぎょう	その人の主な仕事。	音楽は本業ではない。
きょくがい	その仕事や組織の外。	その問題は局外の人には分からない。
きょくしょ	ある限られた場所。	痛みは局所に集まっている。
きょくち	あるせまい地域。	局地的な雨が降った。
きょくちょう	局の責任者。	局長が会議をまとめた。
きょくぶ	体や物の一部分。	けがは足の局部だった。
きょくめん	物事のある場面や状態。	事態は新しい局面に入った。
かいきょく	放送局などを新しく作って始めること。	ラジオ局が開局した。
たいきょく	全体を大きく見たときの流れ。	大局を見て判断する。
とうきょ	その問題を担当している役所や組織。	当局が調査を始めた。
にゅうきょく	局に入ること。	希望して入局した。
ほんきょく	中心となる局。	本局から連絡が入った。
じご	物事が終わったあと。	事後に先生へ報告した。
じじつ	本当に起こったこと。	うわさではなく事実を確かめよう。
じぜん	物事が起こる前。	事前に連絡を入れた。
じぶつ	実際にある物や出来事。	歴史の事物を学んだ。
あくじ	法律や社会の決まりに反する行い。	悪事に関わらないよう気をつける。
かじ	火が出て建物などが燃えること。	近くで火事があった。
かじ	家の中で行う仕事（そうじ・料理など）。	家事を手伝った。
ぎょうじ	決まった時期に行うできごと。	学校の行事を楽しみにしている。
こくじ	国に関わる大切な事がら。	国事として話し合われた。
しょうじ	小さな出来事。	しょうじでも大切にしよう。
しょくじ	食べ物を食べること。	家族で食事をした。
じんじ	人に関する事がらやできごと。	人事の発表があった。
だいじ	とても大切なこと。	健康は大事だ。
みごと	とてもすばらしいようす。	みごとな演技だった。
ようじ	しなければならないこと。	用事があって先に帰る。
じっか	生まれ育った家。	休みに実家へ帰った。
じつがく	実際の生活に役立つ学問。	実学を学ぶと役に立つ。
じっかん	実際に体や心で感じること。	上達を実感した。
じっこう	計画したことを行うこと。	計画を実行した。
じっすう	実際の数。	実数で数えた。
じったい	実際にある姿や中身。	問題の実体が分かった。
じっち	実際の場所や現場。	実地で学ぶ。
じっちょく	正直でまじめなようす。	実直な人だ。
じつぶつ	本物の品。	実物を見て確認した。
じつめい	本当の名前。	実名で申し込む。
じつよう	実際に使えること。	実用的な道具だ。
じつりょく	本当の力や能力。	実力を発揮した。
こうじつ	本当の理由ではなく、言い訳として使う理由。	用事を口実に断った。
ちゃくじつ	一つ一つ確かに進んでいるようす。	努力が着実に実を結んだ。
ないじつ	表に出ていない本当の中身。	話し合いで内実が明らかになった。
めいじつ	名前と実際の内容。	名実ともにリーダーと認められた。
しょかん	見聞きして感じたこと。	見学の所感をまとめた。
しょけん	見たことから考えた意見。	先生の所見を聞いた。
しょぎょう	その人がした行い。	彼の所行は評価された。
しょぎょう	その人が行ったこと（よい意味にも悪い意味にも使う）。	その所業は人々の記憶に残った。
しょさ	動作やふるまい。	所作がていねいだ。
しょちょう	役所や施設の長。	所長が説明した。
しょてい	あらかじめ決められていること。	所定の場所に集まる。
しょよう	用事。	所用で外出する。
きょくしょ	ある限られた場所。	薬を局所にぬる。
じしょ	土地。	祖父は地所を持っている。
でどころ	出てきた場所や原因。	うわさの出所を調べる。
ちょうしょ	よいところ。	長所をのばしたい。
にゅうしょ	施設などに入ること。	新しい施設に入所した。
ばしょ	物や人があるところ。	集合場所を決めた。
みどころ	特に注目すべきところ。	この映画の見所は音楽だ。
めいしょ	有名な場所。	京都は名所が多い。
しんじょう	身分や生活のようす。	身上を明かした。
しんたい	からだ。	身体を大切にする。
しんだい	家の財産。	身代を守る。
しんちょう	背の高さ。	身長がのびた。
みうち	家族や親しい人。	身内で話し合った。
みぶん	社会での立場。	身分をわきまえる。
みもと	その人がどこの誰かということ。	身元が確認された。
こうしん	あとをつぐ人。	後身を育てる。
しゅっしん	生まれ育ったところ。	東京出身です。
しんしん	心と体の両方。	心身ともに元気でいたい。
じんしん	人の体や命。	人身に関わる事故を防ぐ。
ぜんしん	前へ進むこと。	勇気を出して前進した。
ちょうしん	背が高いこと。	兄は長身で目立つ。
てんしん	立場や仕事を変えること。	会社をやめて転身した。
なかみ	中に入っているもの。	箱の中身を確かめた。
なまみ	作り物ではない、本当の体。	生身でぶつかるのは危ない。
ぶんしん	自分の代わりとなる存在。	分身のように働いた。
しんがく	上の学校へ進むこと。	中学へ進学する。
しんげん	目上の人に意見を言うこと。	先生に進言した。
しんこう	物事が進んでいくこと。	工事が順調に進行している。
しんしゅつ	新しい場所や分野へ出ていくこと。	海外へ進出した。
しんすい	船を初めて水に浮かべること。	新しい船が進水した。
しんにゅう	中へ入りこむこと。	立ち入り禁止区域に進入した。
しんもつ	おくりもの。	進物を用意した。
しんろ	これから進む道や方向。	進路を考える時期だ。
こうしん	列になって歩くこと。	音楽に合わせて行進した。
せんしん	進んだ考えや技術をもっていること。	先進的な研究だ。
ちょくしん	まっすぐ進むこと。	道を直進する。
はっしん	動き出すこと。	列車が発進した。
ぜんおん	音の高さのちがいを表す単位。	全音と半音を学んだ。
ぜんかい	全員が集まること。	全会一致で決まった。
ぜんかい	全部を開くこと。	窓を全開にした。
ぜんこく	国じゅうすべて。	全国から参加者が集まった。
ぜんしん	体の全部。	全身がつかれて動けなかった。
ぜんじつ	一日じゅう。	雨が全日降り続いた。
ぜんたい	すべてを合わせたもの。	全体の流れを考えよう。
ぜんちょう	はじめから終わりまでの長さ。	橋の全長を調べた。
ぜんつう	全部が通じること。	電話が全通して安心した。
ぜんぶ	すべて。	宿題は全部終わった。
ぜんぶん	文章のすべて。	全文を声に出して読んだ。
ぜんめん	全体にわたること。	全面的に見直す。
ぜんりょく	持っている力をすべて出すこと。	全力で走った。
しろもの	その物・問題の品。	なかなかの代物だ。
だいきん	物を買ったときに払うお金。	代金をレジで払った。
だいこう	本人の代わりに行うこと。	父の代わりに代行した。
だいさく	他人の代わりに作品を作ること。	代作だと分かった。
だいしょ	他人に代わって書くこと。	手紙を代書してもらった。
だいひつ	本人の代わりに文章を書くこと。	申込書を代筆した。
だいよう	代わりの物として使うこと。	紙を布で代用した。
あしだい	交通に使うお金。	足代を用意する。
くるまだい	車を使うための費用。	車代を精算した。
じょうだい	商品を売るときの値段。	上代を確認する。
しんだい	家の財産。	身代を受けついだ。
せんだい	前の代の人。	先代の社長を知っている。
ぜんだい	前の時代や代。	前代の考え方を学ぶ。
とうだい	今の時代。	当代の名人と呼ばれる。
ねんだい	年の区切りで見た時代。	九十年代の音楽。
なだい	有名であること。	名代の店として知られる。
きもの	日本の伝統的な衣服。	祭りで着物を着た。
ちゃくじつ	一つ一つ確かに進んでいるようす。	準備が着実に進む。
ちゃくしゅ	仕事などを始めること。	計画に着手した。
ちゃくすい	水の上におりること。	飛行機が着水した。
ちゃくち	地面におりること。	無事に着地した。
ちゃくもく	大切だと思って注意して見ること。	先生は結果より努力に着目した。
ちゃくよう	服などを身につけて使うこと。	校内では名札を着用する。
ちゃっか	火がつくこと。	たき火に火が着火した。
うわぎ	上に着る服。	寒いので上着を着た。
したぎ	服の下に着る衣類。	新しい下着を用意した。
しんちゃく	新しく届いたもの。	図書館に新着の本が入った。
せんちゃく	先に着いた順。	先着順で席が決まる。
ていちゃく	ある場所や状態に落ち着くこと。	この方法が学校に定着した。
はっちゃく	出発と到着。	電車の発着時刻を調べる。
みずぎ	水の中で着る服。	夏に水着を着て泳いだ。
ていき	決まった時期ごとに行うこと。	定期検査を受ける。
ていけん	しっかり決まった考え。	自分の定見を持つ。
ていしょく	決まった組み合わせの食事。	昼は定食を食べた。
ていちゃく	しっかり根づいて広まること。	習慣として定着した。
ていねん	仕事をやめることになる年齢。	父は来年定年だ。
こくてい	国が正式に決めたこと。	国定の教科書。
しょてい	あらかじめ決められていること。	所定の時間に集合。
ないてい	正式決定の前に決まること。	進学先が内定した。
へいてい	争いをしずめて落ち着かせること。	国を平定した。
てんか	性質や形が別のものに変わること。	水が氷に転化した。
てんがく	学校を変わること。	引っこしで転学した。
てんぎょう	仕事の種類を変えること。	父は転業を考えている。
てんさく	作る作物を変えること。	畑で転作を行った。
てんしゅつ	他の場所へ移ること。	都会へ転出した。
てんしん	立場や仕事を変えること。	選手から指導者に転身した。
てんせい	生まれ変わること。	物語で転生する。
てんち	住む場所を変えること。	転地して生活を始めた。
てんにゅう	よそから入ってくること。	新しい友だちが転入した。
てんよう	別の目的に使いかえること。	空き教室を転用した。
きてん	その場に合った、すばやい考えのめぐり。	気転がきいて助かった。
くうてん	力が伝わらず、むだに回ること。	タイヤが空転した。
こうてん	うしろ向きに回ること。	体操で後転をした。
ぜんてん	前向きに回ること。	マットで前転を練習した。
どうてん	急なことで気持ちが落ち着かなくなること。	事故の知らせに動転した。
るてん	つぎつぎにうつりかわること。	万物は流転する。
どうさ	体や機械の動き。	ロボットの動作を確認する。
どうぶつ	自分で動き、えさを食べて生きる生き物。	動物を大切にしよう。
どうりょく	物を動かす力。	風力が動力になる。
げんどう	言葉と行い。	言動に気をつける。
げんどう	物事が動き出すもとになること。	原動力になった。
こうどう	考えて実際に行うこと。	正しい行動を選ぶ。
さどう	機械などが動くこと。	ボタンを押すと作動する。
しゅつどう	仕事のために出て行くこと。	消防車が出動した。
しゅどう	人の手で動かすこと。	手動で操作する。
りゅうどう	形や状態が変わりやすく動くこと。	流動的な計画だ。
はいか	命令を受けて動く人たち。	部下や配下が集まった。
はいしゃ	車を割り当てること。	タクシーを配車した。
はいすい	水を分けて送ること。	町の配水が止まった。
はいとう	利益や物を分けて与えること。	会社が配当を出した。
はいぶん	分けて配ること。	時間を公平に配分する。
はいほん	本を各所に配ること。	新刊の配本が始まった。
けはい	何かが起こりそうな様子。	雨の気配がする。
しんぱい	悪いことが起こらないか気にすること。	家族を心配する。
てはい	前もって準備や手続きをすること。	旅行のてはいを早めにすませた。
ねんぱい	年が上の人。	年配の方に席をゆずった。
ぶんぱい	分けて配ること。	おかしを人数分に分配した。
はつい	何かをしようと思いつくこと。	会議で新しい案の発意が出た。
はつおん	言葉の音を声に出すこと。	英語の発音を練習する。
はっか	火が出ること。	機械から発火した。
はっけん	今まで知られていなかったことを見つけること。	新しい星を発見した。
はつげん	考えを言葉にして言うこと。	勇気を出して発言した。
はっこう	本や新聞などを出すこと。	学校新聞を発行した。
はっしゃ	乗り物が出発すること。	電車が発車した。
はっしん	動き出すこと。	ロケットが発進した。
はっせい	物事が起こること。	トラブルが発生した。
はっちゃく	出発と到着。	発着時刻を確認する。
はつどう	働き始めること。	警報が発動した。
ほっさ	急に起こる体や心の変化。	せきの発作が出た。
ほっそく	新しく始まること。	新チームが発足した。
かいはつ	土地や技術を役立つように作り出すこと。	町の開発が進む。
げんぱつ	原子力で電気を作る発電所。	原発の安全について学んだ。
こうはつ	あとから始まること。	後発のチームが追い上げた。
しゅっぱつ	出かけること。	朝早く出発した。
せんぱつ	先に行うこと。	先発の投手が登場した。
ひっとう	いちばんはじめ。	名簿の筆頭に名前がある。
ひつりょく	文章を書く力。	練習で筆力がついた。
ふでさき	筆の先。	筆先を整える。
うんぴつ	筆やえんぴつを動かして字を書くこと。	正しい運筆を身につける。
おおぶで	太い字を書くための大きな筆。	おおぶでで大字を書く。
こぶで	細い字を書くための小さな筆。	こぶでで名前を書く。
じきひつ	本人が自分で書いたもの。	直筆の手紙をもらった。
ぶんぴつ	文章を書いたり表現したりすること。	文筆の仕事にあこがれている。
しなもの	売ったり使ったりする物。	店にいろいろな品物がならんでいる。
ひんこう	人のふるまいや行い。	品行正しく生活する。
ひんめい	商品の名前。	品名をメモしておいた。
ひんもく	品物の種類ごとの区分。	品目ごとに整理する。
きひん	上品で落ち着いた感じ。	話し方に気品がある。
きんぴん	お金や貴重な品物。	金品を大切に保管する。
げひん	上品でないようす。	人をばかにする言い方は下品だ。
さくひん	作った物や書いたもの。	図工で作品を作った。
しゅっぴん	品物を出して売ったり見せたりすること。	作品を展覧会に出品した。
しょうひん	小さな作品。	短い詩は小品として発表された。
じょうひん	礼儀正しく、落ち着いたようす。	上品な話し方を心がける。
しょくひん	食べるための物。	食品を冷ぞう庫に入れる。
しんぴん	新しく作られた物。	新品のノートを使う。
じんぴん	人柄や性格。	人品のいやしからぬ人。
てじな	人をあっと言わせる芸。	手品を見ておどろいた。
めいひん	すぐれた品物。	この焼き物は名品だ。
ようひん	洋服や西洋風の品物。	洋品店で買い物をした。
ようひん	使うための道具。	掃除用品をそろえた。
ぶか	上の人の指示で働く人。	部下と相談して決めた。
ぶがい	その組織や集まりの外。	部外の人には話せない。
ぶすう	本などの数。	発行部数が増えた。
ぶちょう	部のまとめ役。	部長が会議を開いた。
ぶひん	機械などを作るための一部分。	部品を交換した。
ぶぶん	全体の中の一部。	大事な部分を読む。
ぶもん	組織の中の区切り。	営業部門で働く。
がいぶ	外がわ。	外部からの意見を聞く。
がくぶ	大学での学びの区分。	理学部に進学した。
かぶ	下の部分。	山の下部に村がある。
きょくぶ	全体の中の一部分。	痛みは局部にある。
こうぶ	うしろの部分。	車の後部に荷物を積む。
じょうぶ	上の部分。	建物の上部を点検した。
ぜんぶ	すべて。	全部終わった。
ちゅうぶ	まんなかの部分。	日本の中部地方。
とうぶ	頭の部分。	頭部を守る。
ないぶ	中がわ。	内部の様子を見る。
にゅうぶ	部に入ること。	部活に入部した。
ほんぶ	中心となるところ。	本部に連絡する。
ものごころ	物事がわかるようになる心。	物心がついたころの思い出。
ぶったい	形のあるもの。	重い物体を動かす。
ぶっぴん	さまざまな品物。	物品を整理した。
ものおと	物が動いたり当たったりして出る音。	夜に物音がした。
ものみ	見物すること。	城を物見した。
おおもの	大きな力や地位をもつ人。	政界の大物だ。
かなもの	金属でできた物。	金物を修理する。
けんぶつ	実際に見て楽しむこと。	工場を見物した。
こもの	小さな道具や品物。	小物を整理する。
さくもつ	畑や田で作る植物。	今年の作物はよく育った。
じぶつ	実際にある物や出来事。	歴史の事物を学ぶ。
じょうもの	質のよい品。	この魚は上物だ。
しょくもつ	人や動物が食べるもの。	新鮮な食物をとる。
しょもつ	本。	古い書物を読む。
しろもの	その物・問題の品。	なかなかの代物だ。
じんぶつ	ある特徴をもった人。	歴史上の人物を調べた。
しんもつ	おくりもの。	お祝いの進物を用意した。
せいぶつ	生きているもの。	池の生物を観察した。
ながもの	長い形をした物。	長物は運びにくい。
ふうぶつ	その土地や季節を感じさせる物や景色。	春の風物を楽しむ。
ぶんぶつ	文化に関わる物や制度。	文物を守る活動がある。
ほんもの	にせではない、本当の物。	本物かどうか確かめる。
めいぶつ	その土地や店で有名な物。	町の名物を食べた。
ひらて	平らに開いた手。	平手打ちをくう。
ひらめ	海にいる、平たい体の魚。	ひらめの刺身を食べた。
へいき	こわがったり気にしたりしないようす。	彼は平気な顔をしていた。
へいけ	平らな形の家／平氏の一族。	歴史で平家を学ぶ。
へいげん	広くて平らな土地。	草原の平原が広がる。
へいこう	同じ方向に進み、交わらないこと。	二本の線は平行だ。
へいじつ	土日や祝日でない日。	平日は学校がある。
へいぜい	ふだん、いつも。	平生から準備している。
へいち	平らな土地。	平地に家が建つ。
へいてい	争いをおさめて落ち着かせること。	争いを平定した。
へいねん	ふつうの年。	平年より暑い夏だ。
へいほう	正方形の面積の表し方。	辺の長さを平方で表す。
へいめん	平らな面。	紙を平面に置く。
へいや	広くて平らな野原。	草の広がる平野を走った。
へいわ	争いがなく、穏やかな状態。	世界が平和でありますように。
すいへい	水面のように平らなこと。	机が水平か確かめる。
わへい	争いをやめて仲直りすること。	話し合いで和平が成立した。
めいちゅう	ねらったところに当たること。	的に命中した。
めいにち	人が亡くなった日。	祖父の命日に手を合わせた。
めいめい	名前をつけること。	子犬に名前を命名した。
じんめい	人の名前。	名簿に人名を書く。
せいめい	生きていること、そのいのち。	生命を大切にする。
ちょうめい	長く生きること。	祖母は長命だ。
てんめい	天から与えられたと考えられる運命。	天命を信じて進む。
ほんめい	いちばん大切だと思っているもの。	この案が本命だ。
ようめい	命令や仕事を言いつけること。	上司から用命を受けた。
おもなが	顔が縦に長い形。	彼は面長の顔立ちだ。
めんかい	人と直接会うこと。	家族と面会した。
めんぜん	目の前。	面前で説明する。
めんたい	顔つきや表情。	面体が引きしまった。
めんぼく	世間に対する名誉や体面。	面目を保つ。
かいめん	海の水の表面。	夕日が海面に映ってきれいだった。
がいめん	外から見える様子。	外面は元気そうに見えた。
きょくめん	物事のある場面や状態。	事態は新しい局面に入った。
げつめん	月の表面。	ロケットが月面に着陸した。
じめん	地表。	雨で地面がぬれている。
しょめん	書いてある文書。	書面で知らせを受け取った。
じんめん	人の顔。	人面のような岩が話題になった。
すいめん	水の表面。	風で水面がゆれている。
ぜんめん	全体にわたること。	計画を全面的に見直した。
たいめん	人前での立場や名誉。	体面を気にしすぎないほうがいい。
ちょくめん	問題などに直接向かうこと。	大きな課題に直面した。
とうめん	今のところ。	当面はこの方法で進める。
ないめん	心の中や内がわ。	内面の気持ちを大切にする。
ばめん	物事の一場面。	その場面をよく覚えている。
ぶんめん	文章の表現や書きぶり。	文面から気持ちが伝わった。
へいめん	平らな面。	紙を平面に広げる。
ほうめん	向きや分野。	この方面に進みたい。
ろめん	道の表面。	雨で路面がすべりやすい。
ようこう	外国へ行くこと。	父は仕事で洋行した。
ようしょ	西洋の言葉で書かれた本。	図書館で洋書をさがした。
ようじょう	海の上。	船が洋上を進んでいる。
ようしょく	西洋風の料理。	今日は洋食を食べた。
ようひん	洋服や西洋風の品物。	洋品店で買い物をした。
ようふう	西洋の様式。	洋風の家に住んでいる。
かいよう	広い海。	青い海洋が広がる。
がいよう	陸から遠い海。	外洋は波が高い。
たいよう	とても広い海。	大洋を渡る船。
わよう	日本風と西洋風。	和洋折衷の料理。
りゅうえ	予定していた会が中止になること。	天候不良で流会になった。
りゅうかん	インフルエンザのこと。	冬に流感がはやる。
りゅうげん	根拠のないうわさ。	流言にまどわされない。
りゅうこう	多くの人の間で広まること。	この歌が流行している。
りゅうしつ	水などに流されて失われること。	土砂が川に流失した。
りゅうすい	流れている水。	流水で手を洗う。
りゅうたい	液体や気体のように流れるもの。	水は流体の一つだ。
りゅうつう	物やお金が行き来すること。	商品が流通する。
りゅうにゅう	外から中へ流れ込むこと。	人が町に流入した。
りゅうよう	本来の目的とは別に使うこと。	予算を流用した。
るてん	世の中の移り変わりにしたがって変わること。	人生の流転を感じる。
かいりゅう	海の中を流れる水の流れ。	海流によって、魚の動きが変わります。
かりゅう	川の下のほう。	下流に町がある。
きりゅう	空気の流れ。	上空の気流を調べる。
じょうりゅう	川の上のほう。	上流で水をくむ。
すいりゅう	水の流れ。	川の水流が速い。
ちゅうりゅう	川の中ほど／社会の中間の立場。	中流のあたりで魚をとる。
ちょくりゅう	向きが変わらずに流れる電気。	電池は直流を出す。
ふうりゅう	上品で味わいがあるようす。	風流な景色を楽しんだ。
ぶんりゅう	流れがいくつかに分かれること。	川が二つに分流していた。
ほんりゅう	中心となる流れ。	この考え方が本流だ。
ろじ	家と家の間などにあるせまい道。	路地をぬけて近道した。
ろじょう	道の上。	路上で工事が行われている。
ろとう	たよる所がなく、道に出ること。	仕事を失い路頭に迷った。
ろめん	道の表面。	雨で路面がすべりやすい。
あくろ	でこぼこして通りにくい道。	山道は悪路だった。
いえじ	家へ帰る道。	夕方、家路を急いだ。
おおじ	広い道。	大路をまっすぐ進む。
かいろ	海の上の交通路。	昔の海路を調べた。
くうろ	空を通る交通路。	飛行機は空路で向かった。
こうろ	通っていく道。	登山の行路を確認する。
こうじ	せまい道。	小さな小路に入った。
しんろ	これから進む道や方向。	進路について話し合う。
すいろ	水を流したり通したりする道。	畑に水路を作った。
つうろ	人や物が通る道。	通路をふさがないで。
どうろ	人や車が通るための道。	新しい道路ができた。
やまじ	山の中の道。	山路は足元に注意が必要だ。
わおん	いくつかの音を同時に出した音。	ピアノで和音をひいた。
わき	なごやかな気分。	教室に和気が広がった。
わしょ	日本語で書かれた本。	和書を読んで調べた。
わしょく	日本の食事。	和食は体にやさしい。
わふう	日本の様式。	和風の庭が美しい。
わぶん	日本語の文章。	和文で作文を書く。
わめい	日本での名前。	植物の和名を調べる。
ちゅうわ	反対の性質を打ち消しておだやかにすること。	薬で中和した。
ひより	天気や、その日の具合。	今日は行楽日和だ。
`.trim();

function buildJukugoDB(tsv){
  const db = Object.create(null);
  const lines = String(tsv||"").split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
  for(const line of lines){
    const parts = line.split("\t");
    if(parts.length < 2) continue;
    const k = (parts[0]||"").trim();
    const y = (parts[1]||"").trim();
    const imi = (parts[2]||"").trim();
    const rei = (parts[3]||"").trim();
    if(!k) continue;
    if(!db[k]) db[k] = { yomi:y, imi:imi, reibun:rei };
  }
  return db;
}
const JUKUGO_DB = buildJukugoDB(JUKUGO_TSV);
const ANSWER_SET = new Set(Object.keys(JUKUGO_DB));

/* ===== ユーティリティ ===== */
function shuffle(a){
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}
function escapeHtml(s){
  return String(s).replace(/[&<>"']/g, (c)=>( {
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
  }[c] ));
}
function formatReadingLines(s){
  const t = String(s || "").trim();
  if(!t) return "";
  const parts = t.split("・").map(x=>x.trim()).filter(Boolean);
  if(parts.length <= 1) return escapeHtml(t);
  return parts.map(escapeHtml).join("・<br>");
}
function kanjiHtml(k, showReadings){
  if(!showReadings) return escapeHtml(k);
  const r = KANJI_READINGS[k] || { on:"", kun:"" };
  const on = r.on ? formatReadingLines(r.on) : "";
  const kun = r.kun ? formatReadingLines(r.kun) : "";
  return (
    `<div class="kWrap">` +
      `<div class="kOn">${on}</div>` +
      `<div class="kCore">${escapeHtml(k)}</div>` +
      `<div class="kKun">${kun}</div>` +
    `</div>`
  );
}
async function txUpdate(updater){
  if(!roomId) return;
  const stRef = stateRef(roomId);
  return runTransaction(stRef, (cur)=>{
    if(!cur) return cur;
    return updater(cur) || cur;
  });
}
function firstEmptySlot(st){
  if(!st.slot1) return 1;
  if(!st.slot2) return 2;
  return 0;
}
function buildDeckForGrade(gradeKey){
  const pool = KANJI_BY_GRADE[gradeKey] || KANJI_BY_GRADE.g1;
  return shuffle([...pool]);
}

/* ===============================
   UI描画
=============================== */
function renderScoreboardFromState(st){
  scoreboardEl.innerHTML = "";
  const ps = st.players || [];
  for(let i=0;i<2;i++){
    const p = ps[i] || { points:0, skipNext:false, clientId:null };
    const row = document.createElement("div");
    row.className = "pRow" + ((st.started && (st.current===i)) ? " active":"");

    const left = document.createElement("div");
    left.className = "left";
    const dot = document.createElement("span"); dot.className="dot";
    const name = document.createElement("span");
    name.textContent = `プレイヤー${i+1}`;
    left.appendChild(dot);
    left.appendChild(name);

    const pts = document.createElement("div");
    pts.className="pts";
    const pt = document.createElement("span");
    pt.className="ptVal";
    pt.textContent = `${p.points||0} pt`;
    pts.appendChild(pt);

    if(!p.clientId){
      const stg = document.createElement("span");
      stg.className="statusTag miss";
      stg.textContent = "未参加";
      pts.appendChild(stg);
    }else if(p.clientId===myId){
      const stg = document.createElement("span");
      stg.className="statusTag miss";
      stg.textContent = "あなた";
      pts.appendChild(stg);
    }
    if(!!p.skipNext){
      const stg2 = document.createElement("span");
      stg2.className="statusTag";
      stg2.textContent = "次休み";
      pts.appendChild(stg2);
    }

    row.appendChild(left);
    row.appendChild(pts);
    scoreboardEl.appendChild(row);
  }
}

function renderBoardFromState(st){
  const showReadings = !!st.settings?.showReadings;

  fieldEl.innerHTML = "";
  (st.field||[]).forEach((k, idx)=>{
    const d = document.createElement("div");
    d.className = "tile";
    d.dataset.idx = String(idx);
    d.innerHTML = kanjiHtml(k, showReadings);
    d.onclick = ()=> onPickFieldOnline(idx);
    fieldEl.appendChild(d);
  });

  if(st.drawnKanji){
    drawMini.innerHTML = kanjiHtml(st.drawnKanji, showReadings);
    drawChip.disabled = !canActNow(st);
  }else{
    drawMini.textContent = "—";
    drawChip.disabled = true;
  }

  if(st.slot1){ slot1El.innerHTML = kanjiHtml(st.slot1.value, showReadings); }
  else{ slot1El.textContent = "—"; }
  if(st.slot2){ slot2El.innerHTML = kanjiHtml(st.slot2.value, showReadings); }
  else{ slot2El.textContent = "—"; }

  slot1El.classList.toggle("filled", !!st.slot1);
  slot2El.classList.toggle("filled", !!st.slot2);
  wordBox.textContent = (st.slot1 && st.slot2) ? (st.slot1.value + st.slot2.value) : "—";

  madeListEl.innerHTML = "";
  (st.made||[]).forEach(w=>{
    const s = document.createElement("span");
    s.className = "tag";
    s.textContent = w;
    madeListEl.appendChild(s);
  });
}

/* ===============================
   applyRemoteState
=============================== */
function applyRemoteState(st){
  remoteState = st;

  if(!roomId){
    setTop("未接続");
  }else if(!bothJoined(st)){
    setTop("待機中");
  }else if(st.started){
    setTop(`プレイヤー${(st.current??0)+1}の番（オンライン）`);
  }else{
    setTop("準備中（オンライン）");
  }

  if(st.lastMsg) setMsg(st.lastMsg);

  renderScoreboardFromState(st);
  renderBoardFromState(st);

  const canAct = canActNow(st);
  drawBtn.disabled = !canAct || !!st.drewThisTurn;
  checkBtn.disabled = !canAct || !st.drewThisTurn;
  endBtn.disabled = !canAct;

  if(st.holdAdvance){
    skipNextBtn.style.display = "inline-flex";
    skipNextBtn.disabled = !isMyTurn(st);
    drawBtn.disabled = true;
    checkBtn.disabled = true;
    endBtn.disabled = true;
  }else{
    skipNextBtn.style.display = "none";
    skipNextBtn.disabled = true;
  }

  if(st.started && (st.field||[]).length <= 3){
    addFieldBtn.style.display = "inline-flex";
    addFieldBtn.disabled = !canAct;
  }else{
    addFieldBtn.style.display = "none";
    addFieldBtn.disabled = true;
  }

  if(typeof st.winner === "number"){
    winMsgEl.style.display = "block";
    winMsgEl.textContent = `プレイヤー${st.winner+1}の勝ち！`;
  }else{
    winMsgEl.style.display = "none";
  }
}

/* ===============================
   盤面クリック（同期）
=============================== */
async function onPickFieldOnline(idx){
  const st = remoteState;
  if(!st) return;
  if(!canActNow(st)){
    if(st.started && bothJoined(st) && !isMyTurn(st)) setMsg("相手の番です（あなたは操作できません）。","ng");
    return;
  }
  if(!st.drewThisTurn){
    setMsg("先に「１まい引く」を押してね。","ng");
    return;
  }

  await txUpdate((cur)=>{
    if(!cur.started || !bothJoined(cur) || !isMyTurn(cur) || cur.holdAdvance) return cur;
    if(!cur.drewThisTurn) return cur;

    const f = cur.field || [];
    if(idx<0 || idx>=f.length) return cur;

    const already =
      (cur.slot1?.src==="field" && cur.slot1.index===idx) ||
      (cur.slot2?.src==="field" && cur.slot2.index===idx);
    if(already) return cur;

    const n = firstEmptySlot(cur);
    if(n===0) return cur;

    const obj = { src:"field", value: f[idx], index: idx };
    if(n===1) cur.slot1 = obj;
    if(n===2) cur.slot2 = obj;

    cur.lastMsg = "①②をうめて、熟語を作ってね。";
    return cur;
  });
}

drawChip.onclick = async ()=>{
  const st = remoteState;
  if(!st) return;
  if(!canActNow(st)) return;
  if(!st.drewThisTurn){
    setMsg("先に「１まい引く」を押してね。","ng");
    return;
  }
  if(!st.drawnKanji) return;

  await txUpdate((cur)=>{
    if(!cur.started || !bothJoined(cur) || !isMyTurn(cur) || cur.holdAdvance) return cur;
    if(!cur.drewThisTurn || !cur.drawnKanji) return cur;

    const already = (cur.slot1?.src==="draw") || (cur.slot2?.src==="draw");
    if(already) return cur;

    const n = firstEmptySlot(cur);
    if(n===0) return cur;

    const obj = { src:"draw", value: cur.drawnKanji };
    if(n===1) cur.slot1 = obj;
    if(n===2) cur.slot2 = obj;
    cur.lastMsg = "①②をうめて、熟語を作ってね。";
    return cur;
  });
};

slot1El.onclick = async ()=>{
  await txUpdate((cur)=>{
    if(!cur || !cur.started) return cur;
    if(!bothJoined(cur) || !isMyTurn(cur) || cur.holdAdvance) return cur;
    cur.slot1 = null;
    cur.lastMsg = "①を消しました。";
    return cur;
  });
};
slot2El.onclick = async ()=>{
  await txUpdate((cur)=>{
    if(!cur || !cur.started) return cur;
    if(!bothJoined(cur) || !isMyTurn(cur) || cur.holdAdvance) return cur;
    cur.slot2 = null;
    cur.lastMsg = "②を消しました。";
    return cur;
  });
};

/* ===============================
   ターン進行
=============================== */
function nextPlayerInState(cur){
  cur.holdAdvance = false;
  cur.current = ((cur.current ?? 0) + 1) % 2;
  cur.drewThisTurn = false;
  cur.drawnKanji = null;
  cur.missThisTurn = 0;
  cur.slot1 = null;
  cur.slot2 = null;

  const p = cur.players?.[cur.current];
  if(p?.skipNext){
    cur.lastMsg = `プレイヤー${cur.current+1}は休みです。「つぎへ」で進めます。`;
  }else{
    cur.lastMsg = `プレイヤー${cur.current+1}の番です。「１まい引く」から始めます。`;
  }
  return cur;
}
function consumeUsedTilesInState(cur){
  const usedIdx = [];
  if(cur.slot1?.src==="field") usedIdx.push(cur.slot1.index);
  if(cur.slot2?.src==="field") usedIdx.push(cur.slot2.index);

  usedIdx.sort((a,b)=>b-a).forEach(i=>{
    if(typeof i==="number" && i>=0 && i<(cur.field||[]).length){
      cur.field.splice(i,1);
    }
  });

  if(cur.slot1?.src==="draw" || cur.slot2?.src==="draw"){
    cur.drawnKanji = null;
  }
  cur.slot1 = null;
  cur.slot2 = null;
  return cur;
}
function checkWinInState(cur){
  const target = Math.max(1, Number(cur.settings?.targetPoints)||5);
  const winner = (cur.players||[]).findIndex(p => (p.points||0) >= target);
  if(winner >= 0){
    cur.winner = winner;
    cur.started = false;
    cur.holdAdvance = false;
    cur.lastMsg = `プレイヤー${winner+1}の勝ち！`;
    return true;
  }
  return false;
}

/* ===============================
   ボタン操作
=============================== */
startBtn.onclick = async ()=>{
  if(!roomId){ setMsg("先にルーム作成/参加をしてください。","ng"); return; }
  if(!remoteState){ setMsg("接続状態を待っています…","ng"); return; }

  await txUpdate((cur)=>{
    if(!bothJoined(cur)){
      cur.lastMsg = "相手の参加を待っています…";
      return cur;
    }
    cur.settings = {
      gradeKey: gradeSelect.value,
      showReadings: (readingToggle.value === "on"),
      targetPoints: Math.max(1, Number(targetPointsInp.value)||5),
      missLimit: Number(missLimitSel.value)||3
    };
    if(cur.started){
      cur.lastMsg = "すでに開始しています。";
      return cur;
    }
    delete cur.winner;

    cur.players = (cur.players||[]).slice(0,2).map((p,i)=>({
      seat:i,
      clientId: p?.clientId || null,
      points: 0,
      skipNext: false
    }));

    const deck = buildDeckForGrade(cur.settings.gradeKey);
    cur.deck = deck;
    cur.field = cur.deck.splice(0,6);
    cur.started = true;
    cur.current = 0;

    cur.drewThisTurn = false;
    cur.drawnKanji = null;
    cur.missThisTurn = 0;
    cur.slot1 = null;
    cur.slot2 = null;
    cur.made = [];
    cur.holdAdvance = false;

    cur.lastMsg = "プレイヤー1の番です。「１まい引く」から始めます。";
    return cur;
  });
};

resetBtn.onclick = async ()=>{
  if(!roomId){ setMsg("先にルーム作成/参加をしてください。","ng"); return; }

  await txUpdate((cur)=>{
    delete cur.winner;
    cur.started = false;
    cur.deck = [];
    cur.field = [];
    cur.drewThisTurn = false;
    cur.drawnKanji = null;
    cur.missThisTurn = 0;
    cur.slot1 = null;
    cur.slot2 = null;
    cur.made = [];
    cur.holdAdvance = false;
    cur.current = 0;

    cur.players = (cur.players||[]).slice(0,2).map((p,i)=>({
      seat:i,
      clientId: p?.clientId || null,
      points: 0,
      skipNext: false
    }));

    cur.lastMsg = "リセットしました。スタートを押すと開始します。";
    return cur;
  });
};

drawBtn.onclick = async ()=>{
  const st = remoteState;
  if(!st) return;
  if(!canActNow(st)){
    if(st.started && bothJoined(st) && !isMyTurn(st)) setMsg("相手の番です（あなたは操作できません）。","ng");
    return;
  }
  if(st.drewThisTurn) return;

  await txUpdate((cur)=>{
    if(!cur.started || !bothJoined(cur) || !isMyTurn(cur) || cur.holdAdvance) return cur;
    if(cur.drewThisTurn) return cur;
    if((cur.deck||[]).length === 0){
      cur.lastMsg = "山札がなくなりました。もう引けません（リセットしてね）。";
      return cur;
    }
    cur.drawnKanji = cur.deck.pop();
    cur.drewThisTurn = true;
    cur.lastMsg = "引いた札を①②に入れて、熟語を作ってね。";
    return cur;
  });
};

checkBtn.onclick = async ()=>{
  const st = remoteState;
  if(!st) return;
  if(!canActNow(st)){
    if(st.started && bothJoined(st) && !isMyTurn(st)) setMsg("相手の番です（あなたは操作できません）。","ng");
    return;
  }
  if(!st.drewThisTurn){
    setMsg("先に「１まい引く」を押してね。","ng");
    return;
  }

  await txUpdate((cur)=>{
    if(!cur.started || !bothJoined(cur) || !isMyTurn(cur) || cur.holdAdvance) return cur;
    if(!cur.drewThisTurn) return cur;
    if(!cur.slot1 || !cur.slot2){
      cur.lastMsg = "①②をうめてから「できた！」を押してね。";
      return cur;
    }

    const word = cur.slot1.value + cur.slot2.value;
    const missLimit = Number(cur.settings?.missLimit)||3;

    if(!ANSWER_SET.has(word)){
      cur.missThisTurn = (cur.missThisTurn||0) + 1;

      if(cur.missThisTurn >= missLimit){
        const p = cur.players[cur.current];
        if(p) p.skipNext = true;

        if(cur.drawnKanji){ cur.field.push(cur.drawnKanji); }
        cur.drawnKanji = null;
        cur.slot1 = null;
        cur.slot2 = null;

        cur.holdAdvance = true;
        cur.lastMsg = "その言葉はありません。ミスがたまったので、次の自分の番は休みです。「つぎへ」で進めます。";
        return cur;
      }

      cur.lastMsg = "その言葉はありません。";
      return cur;
    }

    const madeArr = cur.made || [];
    if(madeArr.includes(word)){
      cur.lastMsg = "その熟語は、もうできています（同じ熟語は1回まで）。";
      return cur;
    }

    madeArr.push(word);
    cur.made = madeArr;

    const p = cur.players[cur.current];
    if(p) p.points = (p.points||0) + 1;

    consumeUsedTilesInState(cur);

    cur.lastMsg = "正答！ 1ポイント！ つづけて作れます。";

    checkWinInState(cur);
    return cur;
  });
};

endBtn.onclick = async ()=>{
  const st = remoteState;
  if(!st) return;
  if(!canActNow(st)){
    if(st.started && bothJoined(st) && !isMyTurn(st)) setMsg("相手の番です（あなたは操作できません）。","ng");
    return;
  }

  await txUpdate((cur)=>{
    if(!cur.started || !bothJoined(cur) || !isMyTurn(cur) || cur.holdAdvance) return cur;

    if(cur.drawnKanji){
      cur.field.push(cur.drawnKanji);
      cur.drawnKanji = null;
    }
    cur.slot1 = null;
    cur.slot2 = null;

    nextPlayerInState(cur);
    return cur;
  });
};

skipNextBtn.onclick = async ()=>{
  const st = remoteState;
  if(!st || !roomId || !bothJoined(st) || !isMyTurn(st)) return;

  await txUpdate((cur)=>{
    if(!cur.started || !bothJoined(cur) || !isMyTurn(cur)) return cur;

    if(cur.holdAdvance){
      nextPlayerInState(cur);
      return cur;
    }

    const p = cur.players?.[cur.current];
    if(p?.skipNext){
      p.skipNext = false;
      nextPlayerInState(cur);
      return cur;
    }

    cur.lastMsg = "いまは「つぎへ」は使えません。";
    return cur;
  });
};

addFieldBtn.onclick = async ()=>{
  const st = remoteState;
  if(!st || !canActNow(st)) return;

  await txUpdate((cur)=>{
    if(!cur.started || !bothJoined(cur) || !isMyTurn(cur) || cur.holdAdvance) return cur;
    if((cur.deck||[]).length === 0){
      cur.lastMsg = "山札がなくなりました。場札を追加できません。";
      return cur;
    }
    const n = Math.min(3, cur.deck.length);
    for(let i=0;i<n;i++) cur.field.push(cur.deck.pop());
    cur.lastMsg = `場札を追加しました（${n}枚）。`;
    return cur;
  });
};

/* ===============================
   読み表示トグル（表示だけ）
=============================== */
readingToggle.onchange = ()=>{
  if(!remoteState) return;
  const tmp = JSON.parse(JSON.stringify(remoteState));
  tmp.settings = tmp.settings || {};
  tmp.settings.showReadings = (readingToggle.value === "on");
  renderBoardFromState(tmp);
};

/* ===============================
   クリック：ルーム作成/参加
=============================== */
createRoomBtn.addEventListener("click", async ()=>{
  try{
    setMsg("ルーム作成中…");
    await createRoom();
    setMsg("ルームを作成しました。相手にルームIDを伝えて参加してもらってね。","ok");
  }catch(e){
    console.error(e);
    setMsg("ルーム作成に失敗しました（Firebase設定/ルールを確認）。","ng");
  }
});
joinRoomBtn.addEventListener("click", async ()=>{
  const id = (roomIdInput.value||"").trim().toUpperCase();
  if(!id){ setMsg("ルームIDを入れてね。","ng"); return; }
  try{
    setMsg("参加中…");
    await joinRoom(id);
  }catch(e){
    console.error(e);
    setMsg("参加に失敗しました（Firebase設定/ルールを確認）。","ng");
  }
});

/* ===============================
   TTS（遊び方 / 正答のよみ・いみ・れいぶん）
=============================== */
const HAS_SPEECH = ("speechSynthesis" in window) && ("SpeechSynthesisUtterance" in window);
const TTS_DICT = [
  // 追加したければここへ 例：["消防車","しょうぼうしゃ"]
];
function safeCancelSpeech(){
  if(!HAS_SPEECH) return;
  try{ window.speechSynthesis.cancel(); }catch(_){}
}
function ttsNormalize(text){
  let out = String(text ?? "");
  for(const [k, v] of TTS_DICT){ out = out.split(k).join(v); }
  return out;
}
let cachedVoices = [];
function refreshVoices(){
  if(!HAS_SPEECH) return;
  try{ cachedVoices = window.speechSynthesis.getVoices() || []; }catch(_){ cachedVoices = []; }
}
refreshVoices();
if(HAS_SPEECH){
  window.speechSynthesis.onvoiceschanged = refreshVoices;
}
function pickJaVoice(){
  if(!HAS_SPEECH) return null;
  const voices = cachedVoices.length ? cachedVoices : (window.speechSynthesis.getVoices?.() || []);
  return voices.find(v => /ja|JP/i.test(v.lang)) || voices[0] || null;
}
function speakText(text, onEnd){
  if(!HAS_SPEECH){ onEnd && onEnd(); return null; }
  try{
    safeCancelSpeech();
    const u = new SpeechSynthesisUtterance(ttsNormalize(text));
    const v = pickJaVoice();
    if(v) u.voice = v;
    u.lang = "ja-JP";
    u.rate = 1.0;
    u.pitch = 1.0;
    u.onend = ()=>{ onEnd && onEnd(); };
    u.onerror = ()=>{ onEnd && onEnd(); };
    window.speechSynthesis.speak(u);
    return u;
  }catch(e){
    onEnd && onEnd();
    return null;
  }
}

if(!HAS_SPEECH){
  speakBtn.onclick = ()=> setMsg("この環境では音声読み上げが使えません。","ng");
  stopSpeakBtn.onclick = ()=> setMsg("この環境では音声読み上げが使えません。","ng");
  ansSpeakBtn.onclick = ()=> setMsg("この環境では音声読み上げが使えません。","ng");
}else{
  speakBtn.onclick = ()=>{
    const text = [
      "最初に ばふだ が6枚出ます。",
      "自分の ばん では、必ず やまふだ から1枚引きます。1回だけ。",
      "１、２のわくに、ばふだ どうし、または ひきふだ と ばふだ を、タップしていれます。",
      "できたら、できた！ をタップします。正答なら1ポイント。",
      "作れなかったときは、引いた ふだ は ばふだ に並び、ばふだ がどんどん増えます。",
      "ばふだ が3枚以下になったら、ばふだ を追加する のボタンで、ふだ を追加できます。",
      "ばん を終えるとき、手元に残った ひきふだ も ばふだ へ追加されます。",
      "目標ポイントに達した人が勝ち。設定で変更できます。",
      "1ターンで、その言葉はありません、が設定回数出たら、次の自分の ばん は1回休みです。つぎへ、で進みます。"
    ].join(" ");
    speakText(text);
  };
  stopSpeakBtn.onclick = ()=> safeCancelSpeech();
}

/* 正答の「よみ・いみ・れいぶん」 */
let lastCorrectWord = null;
ansSpeakBtn.onclick = ()=>{
  if(!lastCorrectWord) return;
  const info = JUKUGO_DB[lastCorrectWord];
  if(!info) return;

  ansInfo.innerHTML =
    `<div>【${escapeHtml(lastCorrectWord)}】</div>` +
    `<div class="sub">よみ：${escapeHtml(info.yomi || "")}</div>` +
    `<div class="sub">いみ：${escapeHtml(info.imi || "")}</div>` +
    `<div class="sub">れいぶん：${escapeHtml(info.reibun || "")}</div>`;
  ansInfo.style.display = "block";

  const yomi = info.yomi || "";
  const reibunRaw = info.reibun || "";
  const reibunSpeak = (reibunRaw && lastCorrectWord && yomi)
    ? (reibunRaw.split(lastCorrectWord).join(yomi))
    : reibunRaw;

  const speakStr = `よみ、${yomi}。いみ、${info.imi || ""}。れいぶん、${reibunSpeak}`;
  speakText(speakStr, ()=>{
    ansInfo.style.display = "none";
    ansInfo.innerHTML = "";
  });
};

/* ===============================
   くす玉
=============================== */
let lastWinnerShown = null;
function burstKusudama(winnerIndex){
  kusudamaOverlay.style.display = "grid";
  kusudamaOverlay.setAttribute("aria-hidden","false");
  kusudama.classList.remove("burst");
  streamers.innerHTML = "";
  kusudamaBanner.textContent = `プレイヤー${winnerIndex+1}の勝ち！`;

  requestAnimationFrame(()=>{
    kusudama.classList.add("burst");
    for(let i=0;i<18;i++){
      const s = document.createElement("div");
      s.className = "streamer";
      const r = (Math.random()*120 - 60).toFixed(1) + "deg";
      const x = (Math.random()*340 - 170).toFixed(1) + "px";
      s.style.setProperty("--r", r);
      s.style.setProperty("--x", x);
      streamers.appendChild(s);
    }
    setTimeout(()=>{
      kusudamaOverlay.style.display = "none";
      kusudamaOverlay.setAttribute("aria-hidden","true");
    }, 1400);
  });
}

/* applyRemoteState に「後処理」を追加 */
const _applyRemoteState_base = applyRemoteState;
applyRemoteState = function(st){
  _applyRemoteState_base(st);

  const madeArr = st?.made || [];
  const newest = madeArr.length ? madeArr[madeArr.length - 1] : null;
  if(newest && newest !== lastCorrectWord){
    lastCorrectWord = newest;
    ansSpeakBtn.style.display = "inline-flex";
    ansInfo.style.display = "none";
    ansInfo.innerHTML = "";
  }
  if(!newest){
    lastCorrectWord = null;
    ansSpeakBtn.style.display = "none";
    ansInfo.style.display = "none";
    ansInfo.innerHTML = "";
  }

  if(typeof st?.winner === "number"){
    if(lastWinnerShown !== st.winner){
      lastWinnerShown = st.winner;
      burstKusudama(st.winner);
      safeCancelSpeech();
    }
  }else{
    lastWinnerShown = null;
  }

  if(st?.started && bothJoined(st)){
    const cur = st.current ?? 0;
    const p = (st.players||[])[cur];
    if(p?.skipNext && isMyTurn(st)){
      setMsg(`プレイヤー${cur+1}は休みです。「つぎへ」で進めます。`);
    }
  }
};

/* 初期：正答読み上げUIは隠す */
ansSpeakBtn.style.display = "none";
ansInfo.style.display = "none";
</script>
</body>
</html>

